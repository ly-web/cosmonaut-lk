<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=GB2312'/>
        <link type='text/css' href='c_000.css' rel='stylesheet'/>
        <style type='text/css'>
            tr{height:27px;}
            .select{width:180px;_width:150px;}
            .time{width:65px;_width:100px;}
            .txt{width:70px;text-align:center;}
            .short_txt{width:50px;}
            .td_value{text-align:right;padding-right:20px;}
            .td1{padding-left:20px;padding-right:20px;text-align:left;}
            .td2{padding-left:0px;text-align:center;}
            .td3{padding-left:60px;text-align:left;}
            .td4{padding-right:5px;text-align:right;}
            .td5{padding-right:10px;text-align:right;}
            .radio{padding-left:30px;}
            .btnStyle{width:70px;height:24px;}
            .submenu{line-height:32px;padding-left:20px;width:225px;height:32px;color:#000;background-color:#eee;font-weight:normal;font-size:14px;}
            .PagerView{font-size:12px;font-family:tahoma,arial;color:#333;text-align:center;padding:8px;line-height:100%;}
            .PagerView span{color:#999;margin:0 1px;padding:3px 6px;border:1px solid #ccc;}
            .PagerView span.on{color:#fff;font-weight:bold;border:1px solid #666;background:#39f;}
            .PagerView a{color:#00f;text-decoration:none;}
            .PagerView a span{color:#33f;border:1px solid #66c;}
            .pager{width:780px;margin:0 auto;}
        </style>    
        <script type='text/javascript'>
            var $=function(o){return document.getElementById(o);};
            function lang_init_ex(st,end){for(var i=st;i<=end;i++)eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');}
            function show_tip(obj){$('tip').innerHTML=obj;}
            function show_T(tid)
            {
                var str='';
                str+="<div class='title' style='width:90%;'><div class='r1 color'></div><div class='r2 color'></div><div class='r3 color'></div><div class='r4 color'></div>";
                str+="<div class='content color'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 color'></div><div class='r3 color'></div><div class='r2 color'></div><div class='r1 color'></div></div><div class='blank'></div>";
                document.write(str);
            }
            function show_net_pcs()
            {
                var str='';
                str+="<table id='tbl_net_pcs' width='90%' border='1' bordercolor='#E0E0E0' style='display:none;'>";
                for(var i=0; i<60; i++)
                {
                    if(i%2==0){
                        str+="<tr id='trSrv"+i+"' style='display:none;'>";
                        str+="<td width='28%' class='td1 odd' style='text-align:center;'><span id='N"+(564+i*3)+"'></span></td>";
                        str+="<td width='17%' class='td1 odd' style='text-align:center;'><input style='width:135px;text-align:center;' id='SerIP"+i+"' onkeyup='IPverify(this)' type='text'/></td>";
                        str+="<td width='17%' class='td1 odd' style='text-align:center;'><span id='N"+(564+i*3+1)+"'></span></td>";
                        str+="<td width='13%' class='td1 odd' style='text-align:center;'><input style='width:80px;text-align:center;' id='PORT"+i+"' onkeyup='doRangeCheck(this,reg)' type='text'/></td>";
                        str+="<td width='13%' class='td1 odd' style='text-align:center;'><span id='N"+(564+i*3+2)+"'></span></td>";
                        str+="<td width='13%' class='td1 odd' style='text-align:center;'><select style='width:80px;text-align:center;' id='ID"+i+"'></select></td>";
                        str+="<td width='10%' align='right' class='odd'><button class='btnStyle' onclick='doSubmit(this)' id='N"+(50+i)+"' style='display:block;'></button></td>";
                        str+="</tr>";                       
                    }else{
                        str+="<tr id='trSrv"+i+"' style='display:none;'>";
                        str+="<td width='28%' class='td1 even' style='text-align:center;'><span id='N"+(564+i*3)+"'></span></td>";
                        str+="<td width='17%' class='td1 even' style='text-align:center;'><input style='width:135px;text-align:center;' id='SerIP"+i+"' onkeyup='IPverify(this)' type='text'/></td>";
                        str+="<td width='17%' class='td1 even' style='text-align:center;'><span id='N"+(564+i*3+1)+"'></span></td>";
                        str+="<td width='13%' class='td1 even' style='text-align:center;'><input style='width:80px;text-align:center;' id='PORT"+i+"' onkeyup='doRangeCheck(this,reg)' type='text'/></td>";
                        str+="<td width='13%' class='td1 even' style='text-align:center;'><span id='N"+(564+i*3+2)+"'></span></td>";
                        str+="<td width='13%' class='td1 even' style='text-align:center;'><select style='width:80px;text-align:center;' id='ID"+i+"'></select></td>";
                        str+="<td width='10%' align='right' class='even'><button class='btnStyle' onclick='doSubmit(this)' id='N"+(50+i)+"' style='display:block;'></button></td>";
                        str+="</tr>";
                    }
                }
                str+="</table>";
                document.write(str);
            }
            function show_sT(tid)
            {
                var str='';
                str+="<div class='title' style='width:90%;'><div class='subtitle'><div class='r1 subcolor'></div><div class='r2 subcolor'></div><div class='r3 subcolor'></div><div class='r4 subcolor'></div>";
                str+="<div class='content subcolor subcontent'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 subcolor'></div><div class='r3 subcolor'></div><div class='r2 subcolor'></div><div class='r1 subcolor'></div></div><div class='line_short'></div></div>";
                document.write(str);
            }
            function show_sT_ex(tid, id)
            {
                var str='';
                str+="<div class='title' id='"+id+"' style='display:none;width:90%'><div class='subtitle'><div class='r1 subcolor'></div><div class='r2 subcolor'></div><div class='r3 subcolor'></div><div class='r4 subcolor'></div>";
                str+="<div class='content subcolor subcontent'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 subcolor'></div><div class='r3 subcolor'></div><div class='r2 subcolor'></div><div class='r1 subcolor'></div></div><div class='line_short'></div></div>";
                document.write(str);
            }
            function sendHttpReq(url, successFn)
            {
                //alert(url);   
                var xmlhttp;
                if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
                else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
                xmlhttp.onreadystatechange=function()
                {
                    if(xmlhttp.readyState==4 && xmlhttp.status==200)
                    {
                        if(xmlhttp.responseText=='1'){successFn();}
                    }
                };
                xmlhttp.open('GET',url,true);
                xmlhttp.send();
            }   
        var PagerView=function(id,AAA,BBB,CCC)
            {
                var self=this;
                this.id=id;
                this._pageCount=0;
                this._start=1;
                this._end=1;
                this.container=null;
                this.index=1;
                this.size=10;
                this.maxButtons=10;
                this.itemCount=0;
                this.onclick=function(index){return true;};
                this._onclick=function(index)
                {
                    var old=self.index;
                    self.index=index;
                    if(self.onclick(index)!==false)self.render();
                    else self.index=old;
                };
                this._calculate=function()
                {
                    self._pageCount=parseInt(Math.ceil(self.itemCount/self.size));
                    self.index=parseInt(self.index);
                    if(self.index>self._pageCount)self.index=self._pageCount;
                    if(self.index<1)self.index=1;
                    self._start=Math.max(1,self.index-parseInt(self.maxButtons/2));
                    self._end=Math.min(self._pageCount,self._start+self.maxButtons-1);
                    self._start=Math.max(1,self._end-self.maxButtons+1);
                };
                this.page=function(rows)
                {
                    self._calculate();
                    var s_num=(self.index-1)*self.size ;
                    var e_num=self.index*self.size;
                    return rows.slice(s_num,e_num);
                };
                this.render=function()
                {
                    var div=document.getElementById(self.id);
                    div.view=self;
                    self.container=div;
                    self._calculate();
                    var str='';
                    str+='<div class="PagerView">\n';
                    if(self._pageCount>1)
                    {
                        if(self.index!=1)
                        {
                            str+='<a href="javascript://1"><span>|&lt;</span></a>';
                            str+='<a href="javascript://'+(self.index-1)+'"><span>&lt;&lt;</span></a>';
                        }
                        else
                        {
                            str+='<span>|&lt;</span>';
                            str+='<span>&lt;&lt;</span>';
                        }
                    }
                    for(var i=self._start;i<=self._end;i++)
                    {
                        if(i==this.index)
                        {
                            if(i<10)str+='<span class="on">'+'0'+i+"</span>";
                            else str+='<span class="on">'+i+"</span>";
                        }
                        else
                        {
                            if(i<10)str+='<a href="javascript://'+i+'"><span>'+'0'+i+"</span></a>";
                            else str+='<a href="javascript://'+i+'"><span>'+i+"</span></a>";
                        }
                    }
                    if(self._pageCount>1)
                    {
                        if(self.index!=self._pageCount)
                        {
                            str+='<a href="javascript://'+(self.index+1)+'"><span>&gt;&gt;</span></a>';
                            str+='<a href="javascript://'+self._pageCount+'"><span>&gt;|</span></a>';
                        }
                        else
                        {
                            str+='<span>&gt;&gt;</span>';
                            str+='<span>&gt;|</span>';
                        }
                    }
                    str+=AAA+self._pageCount+BBB+self.itemCount+CCC;
                    str+='</div><!--/.pagerView-->\n';
                    self.container.innerHTML=str;
                    var a_list=self.container.getElementsByTagName('a');
                    for(var i=0;i<a_list.length;i++)
                    {
                        a_list[i].onclick=function()
                        {
                            var index=this.getAttribute('href');
                            if(index!=undefined&&index!='')
                            {
                                index=parseInt(index.replace('javascript://',''));
                                self._onclick(index);
                            }
                            return false;
                        };
                    }
                };
            };
        </script>
        <script type='text/javascript'>
            var language=0;
            //正整数+0
            var reg=/^(0|[1-9]\d*)$/;
            var Json;
            var flg_pcs = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
            var lang=
            {
                //PCS 网口
                N50:['设&nbsp;&nbsp;置','Set'],
                N51:['设&nbsp;&nbsp;置','Set'],
                N52:['设&nbsp;&nbsp;置','Set'],
                N53:['设&nbsp;&nbsp;置','Set'],
                N54:['设&nbsp;&nbsp;置','Set'],
                N55:['设&nbsp;&nbsp;置','Set'],
                N56:['设&nbsp;&nbsp;置','Set'],
                N57:['设&nbsp;&nbsp;置','Set'],
                N58:['设&nbsp;&nbsp;置','Set'],
                N59:['设&nbsp;&nbsp;置','Set'],
                N60:['设&nbsp;&nbsp;置','Set'],
                N61:['设&nbsp;&nbsp;置','Set'],
                N62:['设&nbsp;&nbsp;置','Set'],
                N63:['设&nbsp;&nbsp;置','Set'],
                N64:['设&nbsp;&nbsp;置','Set'],
                N65:['设&nbsp;&nbsp;置','Set'],
                N66:['设&nbsp;&nbsp;置','Set'],
                N67:['设&nbsp;&nbsp;置','Set'],
                N68:['设&nbsp;&nbsp;置','Set'],
                N69:['设&nbsp;&nbsp;置','Set'],
                N70:['设&nbsp;&nbsp;置','Set'],
                N71:['设&nbsp;&nbsp;置','Set'],
                N72:['设&nbsp;&nbsp;置','Set'],
                N73:['设&nbsp;&nbsp;置','Set'],
                N74:['设&nbsp;&nbsp;置','Set'],
                N75:['设&nbsp;&nbsp;置','Set'],
                N76:['设&nbsp;&nbsp;置','Set'],
                N77:['设&nbsp;&nbsp;置','Set'],
                N78:['设&nbsp;&nbsp;置','Set'],
                N79:['设&nbsp;&nbsp;置','Set'],
                N80:['设&nbsp;&nbsp;置','Set'],
                N81:['设&nbsp;&nbsp;置','Set'],
                N82:['设&nbsp;&nbsp;置','Set'],
                N83:['设&nbsp;&nbsp;置','Set'],
                N84:['设&nbsp;&nbsp;置','Set'],
                N85:['设&nbsp;&nbsp;置','Set'],
                N86:['设&nbsp;&nbsp;置','Set'],
                N87:['设&nbsp;&nbsp;置','Set'],
                N88:['设&nbsp;&nbsp;置','Set'],
                N89:['设&nbsp;&nbsp;置','Set'],
                N90:['设&nbsp;&nbsp;置','Set'],
                N91:['设&nbsp;&nbsp;置','Set'],
                N92:['设&nbsp;&nbsp;置','Set'],
                N93:['设&nbsp;&nbsp;置','Set'],
                N94:['设&nbsp;&nbsp;置','Set'],
                N95:['设&nbsp;&nbsp;置','Set'],
                N96:['设&nbsp;&nbsp;置','Set'],
                N97:['设&nbsp;&nbsp;置','Set'],
                N98:['设&nbsp;&nbsp;置','Set'],
                N99:['设&nbsp;&nbsp;置','Set'],
                N100:['设&nbsp;&nbsp;置','Set'],
                N101:['设&nbsp;&nbsp;置','Set'],
                N102:['设&nbsp;&nbsp;置','Set'],
                N103:['设&nbsp;&nbsp;置','Set'],
                N104:['设&nbsp;&nbsp;置','Set'],
                N105:['设&nbsp;&nbsp;置','Set'],
                N106:['设&nbsp;&nbsp;置','Set'],
                N107:['设&nbsp;&nbsp;置','Set'],
                N108:['设&nbsp;&nbsp;置','Set'],
                N109:['设&nbsp;&nbsp;置','Set'],

                N500:['一共','Total '],
                N501:['页，共',' Pages, '],
                N502:['页，共',' Page, '],
                N503:['台',' Nums'],
                N504:['台',' Num'],

                N541:['设置失败！','Set failed!'],
                N542:['设置成功！','Set successfully!'],
                N543:['格式错误！','Format error!'],
                N544:['范围错误！','Range error!'],

                N550:['设&nbsp;&nbsp;置','Set'],
                N551:['设&nbsp;&nbsp;置','Set'],

                N564:['储能逆变器01 IP','Server01 IP'],
                N565:['端口号','Port'],
                N566:['ID','ID'],
                N567:['储能逆变器02 IP','Server02 IP'],
                N568:['端口号','Port'],
                N569:['ID','ID'],
                N570:['储能逆变器03 IP','Server03 IP'],
                N571:['端口号','Port'],
                N572:['ID','ID'],
                N573:['储能逆变器04 IP','Server04 IP'],
                N574:['端口号','Port'],
                N575:['ID','ID'],
                N576:['储能逆变器05 IP','Server05 IP'],
                N577:['端口号','Port'],
                N578:['ID','ID'],
                N579:['储能逆变器06 IP','Server06 IP'],
                N580:['端口号','Port'],
                N581:['ID','ID'],
                N582:['储能逆变器07 IP','Server07 IP'],
                N583:['端口号','Port'],
                N584:['ID','ID'],
                N585:['储能逆变器08 IP','Server08 IP'],
                N586:['端口号','Port'],
                N587:['ID','ID'],
                N588:['储能逆变器09 IP','Server09 IP'],
                N589:['端口号','Port'],
                N590:['ID','ID'],
                N591:['储能逆变器10 IP','Server10 IP'],
                N592:['端口号','Port'],
                N593:['ID','ID'],
                N594:['储能逆变器11 IP','Server11 IP'],
                N595:['端口号','Port'],
                N596:['ID','ID'],
                N597:['储能逆变器12 IP','Server12 IP'],
                N598:['端口号','Port'],
                N599:['ID','ID'],
                N600:['储能逆变器13 IP','Server13 IP'],
                N601:['端口号','Port'],
                N602:['ID','ID'],
                N603:['储能逆变器14 IP','Server14 IP'],
                N604:['端口号','Port'],
                N605:['ID','ID'],
                N606:['储能逆变器15 IP','Server15 IP'],
                N607:['端口号','Port'],
                N608:['ID','ID'],
                N609:['储能逆变器16 IP','Server16 IP'],
                N610:['端口号','Port'],
                N611:['ID','ID'],
                N612:['储能逆变器17 IP','Server17 IP'],
                N613:['端口号','Port'],
                N614:['ID','ID'],
                N615:['储能逆变器18 IP','Server18 IP'],
                N616:['端口号','Port'],
                N617:['ID','ID'],
                N618:['储能逆变器19 IP','Server19 IP'],
                N619:['端口号','Port'],
                N620:['ID','ID'],
                N621:['储能逆变器20 IP','Server20 IP'],
                N622:['端口号','Port'],
                N623:['ID','ID'],
                N624:['储能逆变器21 IP','Server21 IP'],
                N625:['端口号','Port'],
                N626:['ID','ID'],
                N627:['储能逆变器22 IP','Server22 IP'],
                N628:['端口号','Port'],
                N629:['ID','ID'],
                N630:['储能逆变器23 IP','Server23 IP'],
                N631:['端口号','Port'],
                N632:['ID','ID'],
                N633:['储能逆变器24 IP','Server24 IP'],
                N634:['端口号','Port'],
                N635:['ID','ID'],
                N636:['储能逆变器25 IP','Server25 IP'],
                N637:['端口号','Port'],
                N638:['ID','ID'],
                N639:['储能逆变器26 IP','Server26 IP'],
                N640:['端口号','Port'],
                N641:['ID','ID'],
                N642:['储能逆变器27 IP','Server27 IP'],
                N643:['端口号','Port'],
                N644:['ID','ID'],               
                N645:['储能逆变器28 IP','Server28 IP'],
                N646:['端口号','Port'],
                N647:['ID','ID'],           
                N648:['储能逆变器29 IP','Server29 IP'],
                N649:['端口号','Port'],
                N650:['ID','ID'],   
                N651:['储能逆变器30 IP','Server30 IP'],
                N652:['端口号','Port'],
                N653:['ID','ID'],
                N654:['储能逆变器31 IP','Server31 IP'],
                N655:['端口号','Port'],
                N656:['ID','ID'],   
                N657:['储能逆变器32 IP','Server32 IP'],
                N658:['端口号','Port'],
                N659:['ID','ID'],
                N660:['储能逆变器33 IP','Server33 IP'],
                N661:['端口号','Port'],
                N662:['ID','ID'],
                N663:['储能逆变器34 IP','Server34 IP'],
                N664:['端口号','Port'],
                N665:['ID','ID'],
                N666:['储能逆变器35 IP','Server35 IP'],
                N667:['端口号','Port'],
                N668:['ID','ID'],
                N669:['储能逆变器36 IP','Server36 IP'],
                N670:['端口号','Port'],
                N671:['ID','ID'],
                N672:['储能逆变器37 IP','Server37 IP'],
                N673:['端口号','Port'],
                N674:['ID','ID'],               
                N675:['储能逆变器38 IP','Server38 IP'],
                N676:['端口号','Port'],
                N677:['ID','ID'],           
                N678:['储能逆变器39 IP','Server39 IP'],
                N679:['端口号','Port'],
                N680:['ID','ID'],   
                N681:['储能逆变器40 IP','Server40 IP'],
                N682:['端口号','Port'],
                N683:['ID','ID'],   
                N684:['储能逆变器41 IP','Server41 IP'],
                N685:['端口号','Port'],
                N686:['ID','ID'],   
                N687:['储能逆变器42 IP','Server42 IP'],
                N688:['端口号','Port'],
                N689:['ID','ID'],
                N690:['储能逆变器43 IP','Server43 IP'],
                N691:['端口号','Port'],
                N692:['ID','ID'],
                N693:['储能逆变器44 IP','Server44 IP'],
                N694:['端口号','Port'],
                N695:['ID','ID'],
                N696:['储能逆变器45 IP','Server45 IP'],
                N697:['端口号','Port'],
                N698:['ID','ID'],
                N699:['储能逆变器46 IP','Server46 IP'],
                N700:['端口号','Port'],
                N701:['ID','ID'],
                N702:['储能逆变器47 IP','Server47 IP'],
                N703:['端口号','Port'],
                N704:['ID','ID'],               
                N705:['储能逆变器48 IP','Server48 IP'],
                N706:['端口号','Port'],
                N707:['ID','ID'],           
                N708:['储能逆变器49 IP','Server49 IP'],
                N709:['端口号','Port'],
                N710:['ID','ID'],   
                N711:['储能逆变器50 IP','Server50 IP'],
                N712:['端口号','Port'],
                N713:['ID','ID'],
                N714:['储能逆变器51 IP','Server51 IP'],
                N715:['端口号','Port'],
                N716:['ID','ID'],
                N717:['储能逆变器52 IP','Server52 IP'],
                N718:['端口号','Port'],
                N719:['ID','ID'],
                N720:['储能逆变器53 IP','Server53 IP'],
                N721:['端口号','Port'],
                N722:['ID','ID'],
                N723:['储能逆变器54 IP','Server54 IP'],
                N724:['端口号','Port'],
                N725:['ID','ID'],
                N726:['储能逆变器55 IP','Server55 IP'],
                N727:['端口号','Port'],
                N728:['ID','ID'],
                N729:['储能逆变器56 IP','Server56 IP'],
                N730:['端口号','Port'],
                N731:['ID','ID'],
                N732:['储能逆变器57 IP','Server57 IP'],
                N733:['端口号','Port'],
                N734:['ID','ID'],
                N735:['储能逆变器58 IP','Server58 IP'],
                N736:['端口号','Port'],
                N737:['ID','ID'],
                N738:['储能逆变器59 IP','Server59 IP'],
                N739:['端口号','Port'],
                N740:['ID','ID'],
                N741:['储能逆变器60 IP','Server60 IP'],
                N742:['端口号','Port'],
                N743:['ID','ID']
            };

            //显示设置Mdobus地址设置框 nid -- text框id(实际的)，bid -- 确认按钮id(>=1)，tid -- 提示信息区id(>=1), num -- 添加的个数
            function show_Set(nid,bid,tid,num)
            {
                var loop=0;
                var str='';
                var style="odd";
                var more=0, all=0;
                var line=0;
                more=num%4;
                if(more!=0){all=num+(4-more);}
                else{all=num;}
                str+="<tr id='t"+(bid+line)+"' style='display:none'>";
                for(var i=0; i<all; i++)
                {
                    if(i%8<4){style="odd"}else{style="even"}
                    if(i>=num){
                        str+="<td width='12%' class='td1 odd "+style+"'><span id='text"+(bid+i)+"'>No.Na</span></td><td width='9%' class='td2 "+style+"'><input class='txt' type='text' value='Na' disabled='true'/></td><td width='8%' class='td2 "+style+"'><button class='btnStyle' disabled='true' style='display:block;'></td>";
                    }else{                      
                        str+="<td width='12%' class='"+style+"'><span id='text"+(bid+i)+"'>No."+(i<9?'0'+(i+1):(i+1))+"</span></td><td width='9%' class='td2 "+style+"'><input class='txt' id='ID_0x0"+(nid+i).toString(16).toUpperCase()+"' value='"+(i+1)+"' maxlength='3' onkeyup='doRangeCheck(this,reg)' type='text'/></td><td width='%8' class='td2 "+style+"'><button class='btnStyle' onclick='doSubmit(this)' id='N"+(bid+i)+"' style='display:block;'></td>"; 
                    }   
                    if(i%4==3){
                        loop=0;
                        line++;
                        if(i!=all-1){str+="</tr><tr id='t"+(bid+line)+"' style='display:none'>"};

                    }
                    loop++;
                }
                str+="</tr>";
                document.write(str);
            }               
        </script>
    </head>
    <body onload='Init()'>
        <!-- PCS -->
        <div id='pager' width='90%' style='padding-left:5%;float:left;'></div>  
        <table id='tbl_pcs' width='90%' border='1' bordercolor="#E0E0E0" style='display:none;'>
            <script type='text/javascript'>
            show_net_pcs();
            </script>
        </table>
        <div class='tip' id='tip' style='width:90%;'><span>&nbsp;</span></div>  
        <div class='btm_blank'></div>
        <div id='trans'></div>
        <!--[if IE 6]><script type='text/javascript'>document.execCommand('BackgroundImageCache',false,true);</script><![endif]-->
    </body>
    <script language='javascript' type='text/javascript'>

        Json={  ID_0x0301:85,ID_0x0282:0x22,ID_0x0390:1,ID_0x0391:1,ID_0x0392:1,ID_0x0393:1,ID_0x0394:1,ID_0x0395:1,ID_0x039A:1,ID_0x0350:60,ID_0x038D:1,

                ID_0x0640:1,ID_0x0641:2,ID_0x0642:3,ID_0x0643:4,ID_0x0644:5,ID_0x0645:6,ID_0x0646:7,ID_0x0647:8,ID_0x0648:9,ID_0x0649:10,
                ID_0x064A:11,ID_0x064B:12,ID_0x064C:13,ID_0x064D:14,ID_0x064E:15,ID_0x064F:16,ID_0x0650:17,ID_0x0651:18,ID_0x0652:19,ID_0x0653:20,
                ID_0x0654:21,ID_0x0655:22,ID_0x0656:23,ID_0x0657:24,ID_0x0658:25,ID_0x0659:26,ID_0x065A:27,ID_0x065B:28,ID_0x065C:29,ID_0x065D:30,
                ID_0x065E:31,ID_0x065F:32,ID_0x0660:33,ID_0x0661:34,ID_0x0662:35,ID_0x0663:36,ID_0x0664:37,ID_0x0665:38,ID_0x0666:39,ID_0x0667:40,
                ID_0x0668:41,ID_0x0669:42,ID_0x066A:43,ID_0x066B:44,ID_0x066C:45,ID_0x066D:46,ID_0x066E:47,ID_0x066F:48,ID_0x0670:49,ID_0x0671:50,
                ID_0x0672:51,ID_0x0673:52,ID_0x0674:53,ID_0x0675:54,ID_0x0676:55,ID_0x0677:56,ID_0x0678:57,ID_0x0679:58,ID_0x067A:59,ID_0x067B:60,

                ID_0x1000:192,ID_0x1001:168,ID_0x1002:0,ID_0x1003:1,ID_0x1004:502,ID_0x1005:192,ID_0x1006:168,ID_0x1007:0,ID_0x1008:2,ID_0x1009:502,
                ID_0x100A:192,ID_0x100B:168,ID_0x100C:0,ID_0x100D:3,ID_0x100E:502,ID_0x100F:192,ID_0x1010:168,ID_0x1011:0,ID_0x1012:4,ID_0x1013:502,
                ID_0x1014:192,ID_0x1015:168,ID_0x1016:0,ID_0x1017:5,ID_0x1018:502,ID_0x1019:192,ID_0x101A:168,ID_0x101B:0,ID_0x101C:6,ID_0x101D:502,
                ID_0x101E:192,ID_0x101F:168,ID_0x1020:0,ID_0x1021:7,ID_0x1022:502,ID_0x1023:192,ID_0x1024:168,ID_0x1025:0,ID_0x1026:8,ID_0x1027:502,
                ID_0x1028:192,ID_0x1029:168,ID_0x102A:0,ID_0x102B:9,ID_0x102C:502,ID_0x102D:192,ID_0x102E:168,ID_0x102F:0,ID_0x1030:10,ID_0x1031:502,
                ID_0x1032:192,ID_0x1033:168,ID_0x1034:0,ID_0x1035:11,ID_0x1036:502,ID_0x1037:192,ID_0x1038:168,ID_0x1039:0,ID_0x103A:12,ID_0x103B:502,
                ID_0x103C:192,ID_0x103D:168,ID_0x103E:0,ID_0x103F:13,ID_0x1040:502,ID_0x1041:192,ID_0x1042:168,ID_0x1043:0,ID_0x1044:14,ID_0x1045:502,
                ID_0x1046:192,ID_0x1047:168,ID_0x1048:0,ID_0x1049:15,ID_0x104A:502,ID_0x104B:192,ID_0x104C:168,ID_0x104D:0,ID_0x104E:16,ID_0x104F:502,
                ID_0x1050:192,ID_0x1051:168,ID_0x1052:0,ID_0x1053:17,ID_0x1054:502,ID_0x1055:192,ID_0x1056:168,ID_0x1057:0,ID_0x1058:18,ID_0x1059:502,
                ID_0x105A:192,ID_0x105B:168,ID_0x105C:0,ID_0x105D:19,ID_0x105E:502,ID_0x105F:192,ID_0x1060:168,ID_0x1061:0,ID_0x1062:20,ID_0x1063:502,
                ID_0x1064:192,ID_0x1065:168,ID_0x1066:0,ID_0x1067:21,ID_0x1068:502,ID_0x1069:192,ID_0x106A:168,ID_0x106B:0,ID_0x106C:22,ID_0x106D:502,
                ID_0x106E:192,ID_0x106F:168,ID_0x1070:0,ID_0x1071:23,ID_0x1072:502,ID_0x1073:192,ID_0x1074:168,ID_0x1075:0,ID_0x1076:24,ID_0x1077:502,
                ID_0x1078:192,ID_0x1079:168,ID_0x107A:0,ID_0x107B:25,ID_0x107C:502,ID_0x107D:192,ID_0x107E:168,ID_0x107F:0,ID_0x1080:26,ID_0x1081:502,
                ID_0x1082:192,ID_0x1083:168,ID_0x1084:0,ID_0x1085:27,ID_0x1086:502,ID_0x1087:192,ID_0x1088:168,ID_0x1089:0,ID_0x108A:28,ID_0x108B:502,
                ID_0x108C:192,ID_0x108D:168,ID_0x108E:0,ID_0x108F:29,ID_0x1090:502,ID_0x1091:192,ID_0x1092:168,ID_0x1093:0,ID_0x1094:30,ID_0x1095:502,
                ID_0x1096:192,ID_0x1097:168,ID_0x1098:0,ID_0x1099:31,ID_0x109A:502,ID_0x109B:192,ID_0x109C:168,ID_0x109D:0,ID_0x109E:32,ID_0x109F:502,
                ID_0x10A0:192,ID_0x10A1:168,ID_0x10A2:0,ID_0x10A3:33,ID_0x10A4:502,ID_0x10A5:192,ID_0x10A6:168,ID_0x10A7:0,ID_0x10A8:34,ID_0x10A9:502,
                ID_0x10AA:192,ID_0x10AB:168,ID_0x10AC:0,ID_0x10AD:35,ID_0x10AE:502,ID_0x10AF:192,ID_0x10B0:168,ID_0x10B1:0,ID_0x10B2:36,ID_0x10B3:502,
                ID_0x10B4:192,ID_0x10B5:168,ID_0x10B6:0,ID_0x10B7:37,ID_0x10B8:502,ID_0x10B9:192,ID_0x10BA:168,ID_0x10BB:0,ID_0x10BC:38,ID_0x10BD:502,
                ID_0x10BE:192,ID_0x10BF:168,ID_0x10C0:0,ID_0x10C1:39,ID_0x10C2:502,ID_0x10C3:192,ID_0x10C4:168,ID_0x10C5:0,ID_0x10C6:40,ID_0x10C7:502,
                ID_0x10C8:192,ID_0x10C9:168,ID_0x10CA:0,ID_0x10CB:41,ID_0x10CC:502,ID_0x10CD:192,ID_0x10CE:168,ID_0x10CF:0,ID_0x10D0:42,ID_0x10D1:502,
                ID_0x10D2:192,ID_0x10D3:168,ID_0x10D4:0,ID_0x10D5:43,ID_0x10D6:502,ID_0x10D7:192,ID_0x10D8:168,ID_0x10D9:0,ID_0x10DA:44,ID_0x10DB:502,
                ID_0x10DC:192,ID_0x10DD:168,ID_0x10DE:0,ID_0x10DF:45,ID_0x10E0:502,ID_0x10E1:192,ID_0x10E2:168,ID_0x10E3:0,ID_0x10E4:46,ID_0x10E5:502,
                ID_0x10E6:192,ID_0x10E7:168,ID_0x10E8:0,ID_0x10E9:47,ID_0x10EA:502,ID_0x10EB:192,ID_0x10EC:168,ID_0x10ED:0,ID_0x10EE:48,ID_0x10EF:502,
                ID_0x10F0:192,ID_0x10F1:168,ID_0x10F2:0,ID_0x10F3:49,ID_0x10F4:502,ID_0x10F5:192,ID_0x10F6:168,ID_0x10F7:0,ID_0x10F8:50,ID_0x10F9:502,
                ID_0x10FA:192,ID_0x10FB:168,ID_0x10FC:0,ID_0x10FD:51,ID_0x10FE:502,ID_0x10FF:192,ID_0x1100:168,ID_0x1101:0,ID_0x1102:52,ID_0x1103:502,
                ID_0x1104:192,ID_0x1105:168,ID_0x1106:0,ID_0x1107:53,ID_0x1108:502,ID_0x1109:192,ID_0x110A:168,ID_0x110B:0,ID_0x110C:54,ID_0x110D:502,
                ID_0x110E:192,ID_0x110F:168,ID_0x1110:0,ID_0x1111:55,ID_0x1112:502,ID_0x1113:192,ID_0x1114:168,ID_0x1115:0,ID_0x1116:56,ID_0x1117:502,
                ID_0x1118:192,ID_0x1119:168,ID_0x111A:0,ID_0x111B:57,ID_0x111C:502,ID_0x111D:192,ID_0x111E:168,ID_0x111F:0,ID_0x1120:58,ID_0x1121:502,
                ID_0x1122:192,ID_0x1123:168,ID_0x1124:0,ID_0x1125:59,ID_0x1126:512,ID_0x1127:192,ID_0x1128:168,ID_0x1129:0,ID_0x112A:60,ID_0x112B:522       
            };

        function IPverify(obj)
        {
            var reg=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/;
            var str = obj.id;
            var cutstr;
            switch(obj.id)
            {
                case 'SerIP0':case 'SerIP1':case 'SerIP2':case 'SerIP3':case 'SerIP4':case 'SerIP5':case 'SerIP6':case 'SerIP7':case 'SerIP8':case 'SerIP9':
                cutstr = str.substring(str.length-1,str.length);
                break;
                default:
                cutstr = str.substring(str.length-2,str.length);
                break;
            }
            var index = parseInt(cutstr)+50;
            if(!obj.value.match(reg))
            {
                eval('$(\'N'+index+'\').disabled=true;');
                obj.style.color='#F00';
                show_tip(lang.N543[language]);
            }
            else
            {
                eval('$(\'N'+index+'\').disabled=false;');
                obj.style.color='#000';
                show_tip('&nbsp;');
            }
        }   
        function change_color(obj)
        {
            if(current_id!=obj.id)
            {
                obj.style.background='#007b3e';
                obj.style.color='#fff';
            }
        }
        function resume_color(obj)
        {
            if(current_id!=obj.id)
            {
                obj.style.background='#aaa';
                obj.style.color='#000';
            }
        }

        //pcs
        function choose_pcs()
        {
            var lin=0;
            if(Json.ID_0x0390==1){ 
                $('tbl_net_pcs').style.display='table';$('pager').style.display='block';            
                $('tip').style.display='block';
            } else { 
                $('tbl_net_pcs').style.display='none'; 
                $('tip').style.display='none';
            }
            //pcs 网口
            if(Json.ID_0x0350<=10){
                if(Json.ID_0x0350==0){$('pager').style.display='none';}
                else if(Json.ID_0x0350==1){
                    $('pager').style.display='block';
                    mpager=new PagerView('pager',lang.N500[language],lang.N502[language],lang.N504[language]);
                }else{
                    $('pager').style.display='block';
                    mpager=new PagerView('pager',lang.N500[language],lang.N502[language],lang.N503[language]);
                }
            }else{
                $('pager').style.display='block';
                mpager=new PagerView('pager',lang.N500[language],lang.N501[language],lang.N503[language]);
            }   
            mpager.itemCount=Json.ID_0x0350;
            mpager.size=10;
            mpager.index=1; 
            Set_PCS_For_Net(mpager.index);              
            mpager.onclick=function(index)
            {
                //获取PCS储能逆变器器配置数据
                Set_PCS_For_Net(index);
            };
            //index显示更新
            mpager.render();          
        }
        //设置串口PCS数据, 获取所有PCS 串口modbus参数
        function Set_PCS_For_Serial()
        {
            var URL='s_027.html?0x0640&time='+new Date();
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);           
                    for(var i=0; i<Json.ID_0x0350; i++)
                    {
                        eval('$(\'ID_0x0'+(0x640+i).toString(16).toUpperCase()+'\').value=Json.ID_0x0'+(0x640+i).toString(16).toUpperCase()+';');
                    }
                }
            };
            //xmlhttp.open('GET',URL,true);
            //xmlhttp.send();  
        }
        //设置网口PCS数据, 获取PCS 单页net参数
        function Set_PCS_For_Net(index)
        {
            eval('var URL=\'s_027.html?0x'+(0x1000+(index-1)*50).toString(16).toUpperCase()+'&time=\'+new Date();');
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);       
                    for(var i=0,cnt=0; i<Json.ID_0x0350; i++)
                    {
                        if(i>=(index-1)*10 && cnt < 10)
                        {
                            cnt++;
                            eval('$(\'trSrv'+i+'\').style.display=\'block\';');
                        }
                        else
                        {
                            eval('$(\'trSrv'+i+'\').style.display=\'none\';');
                        }
                    }   
                    for(var i=(index-1)*10,cnt=0; i<Json.ID_0x0350&&cnt<10; i++,cnt++)
                    {   
                        eval('$(\'SerIP'+i+'\').value=String(Json.ID_0x'+(0x1000+i*5).toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(0x1000+i*5+1).toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(0x1000+i*5+2).toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(0x1000+i*5+3).toString(16).toUpperCase()+');');
                        eval('$(\'SerIP'+i+'\').disabled=false;');
                        eval('$(\'SerIP'+i+'\').style.color=\'#000\';');
                        eval('$(\'PORT'+i+'\').value=Json.ID_0x'+(0x1000+i*5+4).toString(16).toUpperCase()+';');
                        var temp;
                        temp=eval('Json.ID_0x0'+(0x640+i).toString(16).toUpperCase()+'')-1;
                        if(temp>=0)eval('$(\'ID'+i+'\').options[temp].selected=true;');
                    }
                    show_tip('&nbsp;');
                }
            };
            //xmlhttp.open('GET',URL,true);
            //xmlhttp.send();
        }       

        function Init()
        {
            //参数=0读所有设备地址
            var URL='s_027.html?0x0000&time='+new Date();
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);

                    if(Json.ID_0x0301==0x55)language=0;else language=1;
                    lang_init_ex(50,109);
                    lang_init_ex(564,743);

                    //pcs net id
                    for(var i=0;i<60;i++)
                    {
                        for(var j=0; j<247; j++)eval('$(\'ID'+i+'\').options.add(new Option('+(j+1)+','+j+'));');           
                    }

                    //设备选择
                    choose_pcs();

                    if(Json.ID_0x0282==0x11)
                    {
                        $('trans').style.zIndex=-9999;
                    }
                    else
                    {
                        $('trans').style.zIndex=-9999;
                    }                   
                }
            };
            xmlhttp.open('GET',URL,true);
            xmlhttp.send();
        }
        function read_back(addr)
        { 
            var url='s_027.html?';

            if(addr==0x1000){url=url+'0xFFFF'+'&0x1000'+'&0x1001'+'&0x1002'+'&0x1003'+'&0x1004'+'&0x0640';}
            else if(addr==0x1005){url=url+'0xFFFF'+'&0x1005'+'&0x1006'+'&0x1007'+'&0x1008'+'&0x1009'+'&0x0641';}
            else if(addr==0x100A){url=url+'0xFFFF'+'&0x100A'+'&0x100B'+'&0x100C'+'&0x100D'+'&0x100E'+'&0x0642';}
            else if(addr==0x100F){url=url+'0xFFFF'+'&0x100F'+'&0x1010'+'&0x1011'+'&0x1012'+'&0x1013'+'&0x0643';}
            else if(addr==0x1014){url=url+'0xFFFF'+'&0x1014'+'&0x1015'+'&0x1016'+'&0x1017'+'&0x1018'+'&0x0644';}
            else if(addr==0x1019){url=url+'0xFFFF'+'&0x1019'+'&0x101A'+'&0x101B'+'&0x101C'+'&0x101D'+'&0x0645';}
            else if(addr==0x101E){url=url+'0xFFFF'+'&0x101E'+'&0x101F'+'&0x1020'+'&0x1021'+'&0x1022'+'&0x0646';}
            else if(addr==0x1023){url=url+'0xFFFF'+'&0x1023'+'&0x1024'+'&0x1025'+'&0x1026'+'&0x1027'+'&0x0647';}
            else if(addr==0x1028){url=url+'0xFFFF'+'&0x1028'+'&0x1029'+'&0x102A'+'&0x102B'+'&0x102C'+'&0x0648';}
            else if(addr==0x102D){url=url+'0xFFFF'+'&0x102D'+'&0x102E'+'&0x102F'+'&0x1030'+'&0x1031'+'&0x0649';}
            else if(addr==0x1032){url=url+'0xFFFF'+'&0x1032'+'&0x1033'+'&0x1034'+'&0x1035'+'&0x1036'+'&0x064A';}
            else if(addr==0x1037){url=url+'0xFFFF'+'&0x1037'+'&0x1038'+'&0x1039'+'&0x103A'+'&0x103B'+'&0x064B';}
            else if(addr==0x103C){url=url+'0xFFFF'+'&0x103C'+'&0x103D'+'&0x103E'+'&0x103F'+'&0x1040'+'&0x064C';}
            else if(addr==0x1041){url=url+'0xFFFF'+'&0x1041'+'&0x1042'+'&0x1043'+'&0x1044'+'&0x1045'+'&0x064D';}
            else if(addr==0x1046){url=url+'0xFFFF'+'&0x1046'+'&0x1047'+'&0x1048'+'&0x1049'+'&0x104A'+'&0x064E';}
            else if(addr==0x104B){url=url+'0xFFFF'+'&0x104B'+'&0x104C'+'&0x104D'+'&0x104E'+'&0x104F'+'&0x064F';}
            else if(addr==0x1050){url=url+'0xFFFF'+'&0x1050'+'&0x1051'+'&0x1052'+'&0x1053'+'&0x1054'+'&0x0650';}
            else if(addr==0x1055){url=url+'0xFFFF'+'&0x1055'+'&0x1056'+'&0x1057'+'&0x1058'+'&0x1059'+'&0x0651';}
            else if(addr==0x105A){url=url+'0xFFFF'+'&0x105A'+'&0x105B'+'&0x105C'+'&0x105D'+'&0x105E'+'&0x0652';}
            else if(addr==0x105F){url=url+'0xFFFF'+'&0x105F'+'&0x1060'+'&0x1061'+'&0x1062'+'&0x1063'+'&0x0653';}
            else if(addr==0x1064){url=url+'0xFFFF'+'&0x1064'+'&0x1065'+'&0x1066'+'&0x1067'+'&0x1068'+'&0x0654';}
            else if(addr==0x1069){url=url+'0xFFFF'+'&0x1069'+'&0x106A'+'&0x106B'+'&0x106C'+'&0x106D'+'&0x0655';}
            else if(addr==0x106E){url=url+'0xFFFF'+'&0x106E'+'&0x106F'+'&0x1070'+'&0x1071'+'&0x1072'+'&0x0656';}
            else if(addr==0x1073){url=url+'0xFFFF'+'&0x1073'+'&0x1074'+'&0x1075'+'&0x1076'+'&0x1077'+'&0x0657';}
            else if(addr==0x1078){url=url+'0xFFFF'+'&0x1078'+'&0x1079'+'&0x107A'+'&0x107B'+'&0x107C'+'&0x0658';}
            else if(addr==0x107D){url=url+'0xFFFF'+'&0x107D'+'&0x107E'+'&0x107F'+'&0x1080'+'&0x1081'+'&0x0659';}
            else if(addr==0x1082){url=url+'0xFFFF'+'&0x1082'+'&0x1083'+'&0x1084'+'&0x1085'+'&0x1086'+'&0x065A';}
            else if(addr==0x1087){url=url+'0xFFFF'+'&0x1087'+'&0x1088'+'&0x1089'+'&0x108A'+'&0x108B'+'&0x065B';}
            else if(addr==0x108C){url=url+'0xFFFF'+'&0x108C'+'&0x108D'+'&0x108E'+'&0x108F'+'&0x1090'+'&0x065C';}
            else if(addr==0x1091){url=url+'0xFFFF'+'&0x1091'+'&0x1092'+'&0x1093'+'&0x1094'+'&0x1095'+'&0x065D';}
            else if(addr==0x1096){url=url+'0xFFFF'+'&0x1096'+'&0x1097'+'&0x1098'+'&0x1099'+'&0x109A'+'&0x065E';}
            else if(addr==0x109B){url=url+'0xFFFF'+'&0x109B'+'&0x109C'+'&0x109D'+'&0x109E'+'&0x109F'+'&0x065F';}
            else if(addr==0x10A0){url=url+'0xFFFF'+'&0x10A0'+'&0x10A1'+'&0x10A2'+'&0x10A3'+'&0x10A4'+'&0x0660';}
            else if(addr==0x10A5){url=url+'0xFFFF'+'&0x10A5'+'&0x10A6'+'&0x10A7'+'&0x10A8'+'&0x10A9'+'&0x0661';}
            else if(addr==0x10AA){url=url+'0xFFFF'+'&0x10AA'+'&0x10AB'+'&0x10AC'+'&0x10AD'+'&0x10AE'+'&0x0662';}
            else if(addr==0x10AF){url=url+'0xFFFF'+'&0x10AF'+'&0x10B0'+'&0x10B1'+'&0x10B2'+'&0x10B3'+'&0x0663';}
            else if(addr==0x10B4){url=url+'0xFFFF'+'&0x10B4'+'&0x10B5'+'&0x10B6'+'&0x10B7'+'&0x10B8'+'&0x0664';}
            else if(addr==0x10B9){url=url+'0xFFFF'+'&0x10B9'+'&0x10BA'+'&0x10BB'+'&0x10BC'+'&0x10BD'+'&0x0665';}
            else if(addr==0x10BE){url=url+'0xFFFF'+'&0x10BE'+'&0x10BF'+'&0x10C0'+'&0x10C1'+'&0x10C2'+'&0x0666';}
            else if(addr==0x10C3){url=url+'0xFFFF'+'&0x10C3'+'&0x10C4'+'&0x10C5'+'&0x10C6'+'&0x10C7'+'&0x0667';}
            else if(addr==0x10C8){url=url+'0xFFFF'+'&0x10C8'+'&0x10C9'+'&0x10CA'+'&0x10CB'+'&0x10CC'+'&0x0668';}
            else if(addr==0x10CD){url=url+'0xFFFF'+'&0x10CD'+'&0x10CE'+'&0x10CF'+'&0x10D0'+'&0x10D1'+'&0x0669';}
            else if(addr==0x10D2){url=url+'0xFFFF'+'&0x10D2'+'&0x10D3'+'&0x10D4'+'&0x10D5'+'&0x10D6'+'&0x066A';}
            else if(addr==0x10D7){url=url+'0xFFFF'+'&0x10D7'+'&0x10D8'+'&0x10D9'+'&0x10DA'+'&0x10DB'+'&0x066B';}
            else if(addr==0x10DC){url=url+'0xFFFF'+'&0x10DC'+'&0x10DD'+'&0x10DE'+'&0x10DF'+'&0x10E0'+'&0x066C';}
            else if(addr==0x10E1){url=url+'0xFFFF'+'&0x10E1'+'&0x10E2'+'&0x10E3'+'&0x10E4'+'&0x10E5'+'&0x066D';}
            else if(addr==0x10E6){url=url+'0xFFFF'+'&0x10E6'+'&0x10E7'+'&0x10E8'+'&0x10E9'+'&0x10EA'+'&0x066E';}
            else if(addr==0x10EB){url=url+'0xFFFF'+'&0x10EB'+'&0x10EC'+'&0x10ED'+'&0x10EE'+'&0x10EF'+'&0x066F';}
            else if(addr==0x10F0){url=url+'0xFFFF'+'&0x10F0'+'&0x10F1'+'&0x10F2'+'&0x10F3'+'&0x10F4'+'&0x0670';}
            else if(addr==0x10F5){url=url+'0xFFFF'+'&0x10F5'+'&0x10F6'+'&0x10F7'+'&0x10F8'+'&0x10F9'+'&0x0671';}
            else if(addr==0x10FA){url=url+'0xFFFF'+'&0x10FA'+'&0x10FB'+'&0x10FC'+'&0x10FD'+'&0x10FE'+'&0x0672';}
            else if(addr==0x10FF){url=url+'0xFFFF'+'&0x10FF'+'&0x1100'+'&0x1101'+'&0x1102'+'&0x1103'+'&0x0673';}
            else if(addr==0x1104){url=url+'0xFFFF'+'&0x1104'+'&0x1105'+'&0x1106'+'&0x1107'+'&0x1108'+'&0x0674';}
            else if(addr==0x1109){url=url+'0xFFFF'+'&0x1109'+'&0x110A'+'&0x110B'+'&0x110C'+'&0x110D'+'&0x0675';}
            else if(addr==0x110E){url=url+'0xFFFF'+'&0x110E'+'&0x110F'+'&0x1110'+'&0x1111'+'&0x1112'+'&0x0676';}
            else if(addr==0x1113){url=url+'0xFFFF'+'&0x1113'+'&0x1114'+'&0x1115'+'&0x1116'+'&0x1117'+'&0x0677';}
            else if(addr==0x1118){url=url+'0xFFFF'+'&0x1118'+'&0x1119'+'&0x111A'+'&0x111B'+'&0x111C'+'&0x0678';}
            else if(addr==0x111D){url=url+'0xFFFF'+'&0x111D'+'&0x111E'+'&0x111F'+'&0x1120'+'&0x1121'+'&0x0679';}
            else if(addr==0x1122){url=url+'0xFFFF'+'&0x1122'+'&0x1123'+'&0x1124'+'&0x1125'+'&0x1126'+'&0x067A';}
            else if(addr==0x1127){url=url+'0xFFFF'+'&0x1127'+'&0x1128'+'&0x1129'+'&0x112A'+'&0x112B'+'&0x067B';}
            else {url=url+'0xFFFF'+'&0x0'+addr.toString(16).toUpperCase();}
            url=url+'&time='+new Date();
            //alert(url);

            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);
                    //回读PCS 网口参数
                    if(addr==0x1000 || addr==0x1005 || addr==0x100A || addr==0x100F || addr==0x1014 || addr==0x1019 || 
                        addr==0x101E || addr==0x1023 || addr==0x1028 || addr==0x102D || addr==0x1032 || addr==0x1037 || addr==0x103C ||
                          addr==0x1041 || addr==0x1046 || addr==0x104B || addr==0x1050 || addr==0x1055 || addr==0x105F || addr==0x1064 ||
                           addr==0x1069 || addr==0x106E || addr==0x1073 || addr==0x1078 || addr==0x107D || addr==0x1082 || addr==0x1087 ||
                            addr==0x108C || addr==0x1091 || addr==0x1096 || addr==0x109B || addr==0x10A0 || addr==0x10A5 || addr==0x10AA ||
                             addr==0x10AF || addr==0x10B4 || addr==0x10B9 || addr==0x10BE || addr==0x10C3 || addr==0x10C8 || addr==0x10CD ||
                              addr==0x10D2 || addr==0x10D7 || addr==0x10DC || addr==0x10E1 || addr==0x10E6 || addr==0x10EB || addr==0x10F0 || 
                               addr==0x10F5 || addr==0x10FA || addr==0x10FF || addr==0x1104 || addr==0x1109 || addr==0x110E || addr==0x1113 || 
                                addr==0x1118 || addr==0x111D || addr==0x1122 || addr==0x1127)
                    {
                        var index = (addr-0x1000)/5;
                        eval('var ip=$(\'SerIP'+index+'\').value;'); 
                        eval('var ip_get=String(Json.ID_0x'+addr.toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(addr+1).toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(addr+2).toString(16).toUpperCase()+')+\'.\'+String(Json.ID_0x'+(addr+3).toString(16).toUpperCase()+');');  
                        eval('var port=$(\'PORT'+index+'\').value;');
                        eval('var port_get=Json.ID_0x'+(addr+4).toString(16).toUpperCase()+';');
                        eval('var id=$(\'ID'+index+'\').selectedIndex+1;');
                        eval('var id_get=Json.ID_0x0'+(0x640+index).toString(16).toUpperCase()+';');
                        show_tip('&nbsp;');
                        if(ip!=ip_get || port!=port_get || id!=id_get){
                            eval('$(\'SerIP'+index+'\').value=ip_get;');
                            eval('$(\'PORT'+index+'\').value=port_get;');
                            eval('$(\'ID'+index+'\').options[Json.ID_0x0'+(0x640+index).toString(16).toUpperCase()+'-1].selected=true;');
                            setTimeout('show_tip(lang.N541[language])',500);        
                        }else{
                            setTimeout('show_tip(lang.N542[language])',500);
                        }
                        setTimeout('show_tip(\'&nbsp;\')',2500);
                    }
                    //回读PCS modbus地址    
                    else if(addr >= 0x640 && addr <= 0x67B)
                    {
                        var pr,fe;
                        eval('pr=$(\'ID_0x0'+addr.toString(16).toUpperCase()+'\').value;');
                        eval('fe=Json.ID_0x0'+addr.toString(16).toUpperCase()+';');
                        if(pr!=fe) eval('$(\'ID_0x0'+addr.toString(16).toUpperCase()+'\').value=Json.ID_0x0'+addr.toString(16).toUpperCase()+';');                      
                        show_tip('&nbsp;');
                        if(pr==fe){setTimeout('show_tip(lang.N542[language])',500);}
                        else {setTimeout('show_tip(lang.N541[language])',500);}
                        setTimeout('show_tip(\'&nbsp;\')',2500);
                    }
                }
            };
            xmlhttp.open('GET',url,true);
            xmlhttp.send();     
        }   

        function doSubmit(obj)
        {
            var URL='a_027.html?';

            var readBack=0;
            switch(obj.id)
            {
                //net pcs 设置
                case 'N50': case 'N51': case 'N52': case 'N53': case 'N54': case 'N55': case 'N56': case 'N57': case 'N58': case 'N59':
                case 'N60': case 'N61': case 'N62': case 'N63': case 'N64': case 'N65': case 'N66': case 'N67': case 'N68': case 'N69':
                case 'N70': case 'N71': case 'N72': case 'N73': case 'N74': case 'N75': case 'N76': case 'N77': case 'N78': case 'N79':
                case 'N80': case 'N81': case 'N82': case 'N83': case 'N84': case 'N85': case 'N86': case 'N87': case 'N88': case 'N89':
                case 'N90': case 'N91': case 'N92': case 'N93': case 'N94': case 'N95': case 'N96': case 'N97': case 'N98': case 'N99':
                var str = obj.id;
                var cutstr = str.substring(str.length-2,str.length);
                var index = parseInt(cutstr)-50;
                eval('var ip=$(\'SerIP'+index+'\').value.split(\'.\');');
                eval('var id=$(\'ID'+index+'\').selectedIndex+1;');
                eval('URL=URL+\'0x'+(0x1000+5*index).toString(16).toUpperCase()+'=\'+ip[0]+\'&0x'+(0x1000+5*index+1).toString(16).toUpperCase()+'=\'+ip[1]+\'&0x'+(0x1000+5*index+2).toString(16).toUpperCase()+'=\'+ip[2]+\'&0x'+(0x1000+5*index+3).toString(16).toUpperCase()+'=\'+ip[3]+\'&0x'+(0x1000+5*index+4).toString(16).toUpperCase()+'=\'+$(\'PORT'+index+'\').value+\'&0x0'+(0x640+index).toString(16).toUpperCase()+'=\'+id;');    
                eval('readBack=0x'+(0x1000+5*index).toString(16).toUpperCase()+';');
                break;
                case 'N100': case 'N101': case 'N102': case 'N103': case 'N104': case 'N105': case 'N106': case 'N107': case 'N108': case 'N109':
                var str = obj.id;
                var cutstr = str.substring(str.length-3,str.length);
                var index = parseInt(cutstr)-50;
                eval('var ip=$(\'SerIP'+index+'\').value.split(\'.\');');
                eval('var id=$(\'ID'+index+'\').selectedIndex+1;');
                eval('URL=URL+\'0x'+(0x1000+5*index).toString(16).toUpperCase()+'=\'+ip[0]+\'&0x'+(0x1000+5*index+1).toString(16).toUpperCase()+'=\'+ip[1]+\'&0x'+(0x1000+5*index+2).toString(16).toUpperCase()+'=\'+ip[2]+\'&0x'+(0x1000+5*index+3).toString(16).toUpperCase()+'=\'+ip[3]+\'&0x'+(0x1000+5*index+4).toString(16).toUpperCase()+'=\'+$(\'PORT'+index+'\').value+\'&0x0'+(0x640+index).toString(16).toUpperCase()+'=\'+id;');    
                eval('readBack=0x'+(0x1000+5*index).toString(16).toUpperCase()+';');
                break;
                default:break;
            }

            URL=URL+'&time='+new Date();
            //alert(URL);          

            function success()
            {
                if((readBack >= 0x640 && readBack <= 0x67B) || (readBack >= 0x1000 && readBack <= 0x112B))
                {
                    show_tip('&nbsp;');
                    setTimeout('read_back('+readBack+')', 100);
                    setTimeout('show_tip(\'&nbsp;\')',2500);                    
                }       
            } 

            //测试
            success();  

            sendHttpReq(URL, success);
        }

        function show_tip_ex(id, obj){eval('$(\'tip'+id+'\').innerHTML=obj;');}
        function doRangeCheck(obj,reg)
        {
            var range=parseInt(obj.value);
            var err, err2;          

            if(!obj.value.match(reg)){err=2;}
            else if(range<1||range>247){err=1;}
            else{err=0;}
    
            //pcs 网口    
            if(!obj.value.match(reg)){err2=2;}
            else if(range>=100000||range==0||range==80||range==8080){err2=1;}
            else{err2=0;}

            switch(obj.id)
            {
                case "PORT0": case "PORT1": case "PORT2": case "PORT3": case "PORT4": case "PORT5": case "PORT6": case "PORT7": case "PORT8": case "PORT9":  
                case "PORT10": case "PORT11": case "PORT12": case "PORT13": case "PORT14": case "PORT15": case "PORT16": case "PORT17": case "PORT18": case "PORT19": 
                case "PORT20": case "PORT21": case "PORT22": case "PORT23": case "PORT24": case "PORT25": case "PORT26": case "PORT27": case "PORT28": case "PORT29":  
                case "PORT30": case "PORT31": case "PORT32": case "PORT33": case "PORT34": case "PORT35": case "PORT36": case "PORT37": case "PORT38": case "PORT39":  
                case "PORT40": case "PORT41": case "PORT42": case "PORT43": case "PORT44": case "PORT45": case "PORT46": case "PORT47": case "PORT48": case "PORT49":  
                case "PORT50": case "PORT51": case "PORT52": case "PORT53": case "PORT54": case "PORT55": case "PORT56": case "PORT57": case "PORT58": case "PORT59":
                if(err2==1||err2==2){
                    for(var i=0; i<Json.ID_0x0350; i++)
                    {
                        if(eval('$(\'PORT'+i+'\').id')==obj.id) {flg_pcs[i]=1;eval('$(\'N'+(50+i)+'\').disabled=true;');break;}
                    }   
                }
                if(err2==1)show_tip(lang.N544[language]);
                else if(err2==2)show_tip(lang.N543[language]);
                else{
                    for(var i=0; i<Json.ID_0x0350; i++)
                    {
                        if(eval('$(\'PORT'+i+'\').id')==obj.id) {flg_pcs[i]=0;eval('$(\'N'+(50+i)+'\').disabled=false;');break;}
                    }                           
                    var a=0;
                    for(var i=0; i<60; i++) a|=flg_pcs[i];
                    if(a==0)show_tip("&nbsp;");                         
                }
                break;
            }                    
        }
    </script>
</html>
