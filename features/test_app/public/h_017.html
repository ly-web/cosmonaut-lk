<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=GB2312'/>
        <link type='text/css' href='c_000.css' rel='stylesheet'/>
        <script src='j_001.js' type='text/javascript'></script>
        <style type='text/css'>
        tr{height:27px;}
        .td1{text-align:left;padding-left:40px;}
        .td2{text-align:right;padding-right:5px;}
        .td3{text-align:right;padding-right:40px;}
        .div_tab{width:780px;height:45px;margin:0 auto;}
        .div_btn{width:80px;margin:0 auto;height:30px;text-align:right;margin-top:8px;float:left;}
        .div_text{width:80px;margin:0 auto;height:25px;text-align:right;margin-top:10px;float:left;}
        .div_span{width:40px;margin:0 auto;height:25px;font-size:16px;font-weight:bold;text-align:right;margin-top:12px;float:left;}
        .btn{width:75px;height:30px;}
        .PagerView{font-size:14px;font-family:tahoma,arial;font-weight:bold;color:#333;text-align:center;padding:8px;line-height:100%;}
        .PagerView span{color:#999;margin:0 1px;padding:3px 6px;border:1px solid #ccc;}
        .PagerView span.on{color:#fff;font-weight:bold;border:1px solid #666;background:#888;} 
        .PagerView a{color:#00f;text-decoration:none;}
        .PagerView a span{color:#33f;border:1px solid #888;}
        .pager{width:780px;margin:0 auto;}
        </style>
        <script type='text/javascript'>
            var TAB1_1="tab1_1";
            var DC1_1=new Array('N003','','N004','','N005','','N006','','N007','','N008','','N009','','N010','');
            var DC1_2=new Array('ID_0x0078','','ID_0x0071','','ID_0x0072','','ID_0x0073','','ID_0x0074','','ID_0x0075','','ID_0x0076','','ID_0x0077','');
            var DC1_3=new Array('','','V','','A','','V','','A','','Kw','','℃','','℃','');

            var TAB1_2="tab1_2";
            var DC2_1=new Array('N012','','N013','','N014','','N015','','N016','','N017','','N018','','N019','');
            var DC2_2=new Array('ID_0x008C','','ID_0x0085','','ID_0x0086','','ID_0x0087','','ID_0x0088','','ID_0x0089','','ID_0x008A','','ID_0x008B','');
            var DC2_3=new Array('','','V','','A','','V','','A','','Kw','','℃','','℃','');

            var TAB1_3="tab1_3";
            var DC3_1=new Array('N021','','N022','','N023','','N024','','N025','','N026','','N027','','N028','');
            var DC3_2=new Array('ID_0x00A0','','ID_0x0099','','ID_0x009A','','ID_0x009B','','ID_0x009C','','ID_0x009D','','ID_0x009E','','ID_0x009F','');
            var DC3_3=new Array('','','V','','A','','V','','A','','Kw','','℃','','℃','');

            var TAB1_4="tab1_4";
            var DC4_1=new Array('N030','','N031','','N032','','N033','','N034','','N035','','N036','','N037','');
            var DC4_2=new Array('ID_0x00B4','','ID_0x00AD','','ID_0x00AE','','ID_0x00AF','','ID_0x00B0','','ID_0x00B1','','ID_0x00B2','','ID_0x00B3','');
            var DC4_3=new Array('','','V','','A','','V','','A','','Kw','','℃','','℃','');

            var TAB2_1="tab2_1";
            var DC2_1_1=new Array('N101','','N102','','N103','','N104','','N105','','N106','','N107','','N108','');
            var DC2_1_2=new Array('ID_0x00F1','','ID_0x00F2','','ID_0x00F3','','ID_0x00F4','','ID_0x00F5','','ID_0x00F6','','ID_0x00F7','','ID_0x00F8','');
            var DC2_1_3=new Array('','','','','V','','A','','V','','A','','℃','','℃',''); 

            var TAB2_2="tab2_2";
            var DC2_2_1=new Array('N111','','N112','','N113','','N114','','N115','','N116','','N117','','N118','');
            var DC2_2_2=new Array('ID_0x0101','','ID_0x0102','','ID_0x0103','','ID_0x0104','','ID_0x0105','','ID_0x0106','','ID_0x0107','','ID_0x0108','');
            var DC2_2_3=new Array('','','','','V','','A','','V','','A','','℃','','℃','');     

            var TAB2_3="tab2_3";
            var DC2_3_1=new Array('N121','','N122','','N123','','N124','','N125','','N126','','N127','','N128','');
            var DC2_3_2=new Array('ID_0x0111','','ID_0x0112','','ID_0x0113','','ID_0x0114','','ID_0x0115','','ID_0x0116','','ID_0x0117','','ID_0x0118','');
            var DC2_3_3=new Array('','','','','V','','A','','V','','A','','℃','','℃','');          

            var TAB2_4="tab2_4";
            var DC2_4_1=new Array('N131','','N132','','N133','','N134','','N135','','N136','','N137','','N138','');
            var DC2_4_2=new Array('ID_0x0121','','ID_0x0122','','ID_0x0123','','ID_0x0124','','ID_0x0125','','ID_0x0126','','ID_0x0127','','ID_0x0128','');
            var DC2_4_3=new Array('','','','','V','','A','','V','','A','','℃','','℃',''); 
            function show_sT_ex(bid, tid)
            {
                var str='';
                str+="<div class='title' id='"+bid+"' style='width:90%;'><div class='subtitle'><div class='r1 subcolor'></div><div class='r2 subcolor'></div><div class='r3 subcolor'></div><div class='r4 subcolor'></div>";
                str+="<div class='content subcolor subcontent'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 subcolor'></div><div class='r3 subcolor'></div><div class='r2 subcolor'></div><div class='r1 subcolor'></div></div><div class='line_short'></div></div>";
                document.write(str);
            }
            function show_line(id)
            {
                var str='';
                str+="<div id='"+id+"' class='line_long'></div>";
                document.write(str);
            }
            function show_SUB(TAB,TR1,TR2,TR3)
            {
                var str='';
                str+="<table id='"+TAB+"' width='90%' border='0' style='display:none;'>";
                for(var i=0;i<TR1.length;i+=2)
                {
                    str+="<tr id='"+TR1[i]+i+"'>";
                        str+="<td width='40%' class='td1 "+(i%4?"even":"odd")+"'><span id='"+TR1[i]+"'></span></td>";
                        str+="<td width='30%' class='td2 "+(i%4?"even":"odd")+"'><span id='"+TR2[i]+"'></span></td>";
                        str+="<td width='30%' class='td3 "+(i%4?"even":"odd")+"'>"+TR3[i]+"</td>";
                        if(i+1!=TR1.length)
                        {
                            str+="<td width='40%' class='td1 "+(i%4?"even":"odd")+"'><span id='"+TR1[i+1]+"'></span></td>";
                            str+="<td width='30%' class='td2 "+(i%4?"even":"odd")+"'><span id='"+TR2[i+1]+"'></span></td>";
                            str+="<td width='30%' class='td3 "+(i%4?"even":"odd")+"'>"+TR3[i+1]+"</td>";
                        }
                        else
                        {
                            str+="<td width='40%' class='td1 "+(i%4?"even":"odd")+"'></td>";
                            str+="<td width='30%' class='td2 "+(i%4?"even":"odd")+"'></td>";
                            str+="<td width='30%' class='td3 "+(i%4?"even":"odd")+"'></td>";
                        }
                        
                    str+="</tr>";
                }
                str+="</table>";
                document.write(str);
            }
        var PagerView=function(id,AAA,BBB,CCC)
            {
                var self=this;
                this.id=id;
                this._pageCount=0;
                this._start=1;
                this._end=1;
                this.container=null;
                this.index=1;
                this.size=10;
                this.maxButtons=18;
                this.itemCount=0;
                this.onclick=function(index){return true;};
                this._onclick=function(index)
                {
                    var old=self.index;
                    self.index=index;
                    if(self.onclick(index)!==false)self.render();
                    else self.index=old;
                };
                this._calculate=function()
                {
                    self._pageCount=parseInt(Math.ceil(self.itemCount/self.size));
                    self.index=parseInt(self.index);
                    if(self.index>self._pageCount)self.index=self._pageCount;
                    if(self.index<1)self.index=1;
                    self._start=Math.max(1,self.index-parseInt(self.maxButtons/2));
                    self._end=Math.min(self._pageCount,self._start+self.maxButtons-1);
                    self._start=Math.max(1,self._end-self.maxButtons+1);
                };
                this.page=function(rows)
                {
                    self._calculate();
                    var s_num=(self.index-1)*self.size ;
                    var e_num=self.index*self.size;
                    return rows.slice(s_num,e_num);
                };
                this.render=function()
                {
                    var div=document.getElementById(self.id);
                    div.view=self;
                    self.container=div;
                    self._calculate();
                    var str='';
                    str+='<div class="PagerView">\n';
                    if(self._pageCount>1)
                    {
                        if(self.index!=1)
                        {
                            str+='<a href="javascript://1"><span>|&lt;</span></a>';
                            str+='<a href="javascript://'+(self.index-1)+'"><span>&lt;&lt;</span></a>';
                        }
                        else
                        {
                            str+='<span>|&lt;</span>';
                            str+='<span>&lt;&lt;</span>';
                        }
                    }
                    for(var i=self._start;i<=self._end;i++)
                    {
                        if(i==this.index)
                        {
                            if(i<10)str+='<span class="on">'+'0'+i+"</span>";
                            else str+='<span class="on">'+i+"</span>";
                        }
                        else
                        {
                            if(i<10)str+='<a href="javascript://'+i+'"><span>'+'0'+i+"</span></a>";
                            else str+='<a href="javascript://'+i+'"><span>'+i+"</span></a>";
                        }
                    }
                    if(self._pageCount>1)
                    {
                        if(self.index!=self._pageCount)
                        {
                            str+='<a href="javascript://'+(self.index+1)+'"><span>&gt;&gt;</span></a>';
                            str+='<a href="javascript://'+self._pageCount+'"><span>&gt;|</span></a>';
                        }
                        else
                        {
                            str+='<span>&gt;&gt;</span>';
                            str+='<span>&gt;|</span>';
                        }
                    }
                    str+=AAA+self._pageCount+BBB+self.itemCount+CCC;
                    str+='</div><!--/.pagerView-->\n';
                    self.container.innerHTML=str;
                    var a_list=self.container.getElementsByTagName('a');
                    for(var i=0;i<a_list.length;i++)
                    {
                        a_list[i].onclick=function()
                        {
                            var index=this.getAttribute('href');
                            if(index!=undefined&&index!='')
                            {
                                index=parseInt(index.replace('javascript://',''));
                                self._onclick(index);
                            }
                            return false;
                        };
                    }
                };
            };
        </script>
    </head>
    <body onload='Init();'>
        <script type='text/javascript'>
            show_T('N001');
        </script>        
        <div id='pager' width='90%' style='padding-left:5%;float:left;'></div>
        <div class='line_long'></div>
        <div class='blank'></div>
        <script type='text/javascript'>
            show_sT('N002');
            show_SUB(TAB1_1,DC1_1,DC1_2,DC1_3);
            show_SUB(TAB2_1,DC2_1_1,DC2_1_2,DC2_1_3);
        </script>
        <div class='line_long'></div>
        <div class='blank'></div>      
        <script type='text/javascript'>
            show_sT('N011');
            show_SUB(TAB1_2,DC2_1,DC2_2,DC2_3);
            show_SUB(TAB2_2,DC2_2_1,DC2_2_2,DC2_2_3);
        </script>
        <div class='line_long'></div>
        <div class='blank'></div>   
        <script type='text/javascript'>
            show_sT('N020');
            show_SUB(TAB1_3,DC3_1,DC3_2,DC3_3);
            show_SUB(TAB2_3,DC2_3_1,DC2_3_2,DC2_3_3);
        </script>
        <div class='line_long'></div>
        <div class='blank'></div>   
        <script type='text/javascript'>
            show_sT_ex('tmode4', 'N029');
            //show_SUB(TAB1_4,DC4_1,DC4_2,DC4_3);
            show_SUB(TAB2_4,DC2_4_1,DC2_4_2,DC2_4_3);
            show_line('line');
        </script>
        <div class='blank'></div>   
        <!--[if IE 6]><script type='text/javascript'>document.execCommand('BackgroundImageCache',false,true);</script><![endif]-->
    </body>
    <script type='text/javascript'>
        window.history.forward(1);
        var $=function(o){return document.getElementById(o);};
        var language=0;
        var Json;
        var CurDcdc;
        var lang=
        {
            N001:['光伏控制器信息','DCDC Information'],

            N002:['模块 1#','Module 1#'],
            N003:['状态','Status'],
            N004:['阵列电压','Array V'],
            N005:['阵列电流','Array I'],
            N006:['电池电压','Bat. V'],
            N007:['充电电流','Charge I'],
            N008:['充电功率','Charge p'],
            N009:['机内温度','Inside T'],
            N010:['电池温度','Bat. T'],

            N011:['模块 2#','Module 2#'],
            N012:['状态','Status'],
            N013:['阵列电压','Array V'],
            N014:['阵列电流','Array I'],
            N015:['电池电压','Bat. V'],
            N016:['充电电流','Charge I'],
            N017:['充电功率','Charge p'],
            N018:['机内温度','Inside T'],
            N019:['电池温度','Bat. T'],   

            N020:['模块 3#','Module 3#'],
            N021:['状态','Status'],
            N022:['阵列电压','Array V'],
            N023:['阵列电流','Array I'],
            N024:['电池电压','Bat. V'],
            N025:['充电电流','Charge I'],
            N026:['充电功率','Charge p'],
            N027:['机内温度','Inside T'],
            N028:['电池温度','Bat. T'],  

            N029:['模块 4#','Module 4#'],
            N030:['状态','Status'],
            N031:['阵列电压','Array V'],
            N032:['阵列电流','Array I'],
            N033:['电池电压','Bat. V'],
            N034:['充电电流','Charge I'],
            N035:['充电功率','Charge p'],
            N036:['机内温度','Inside T'],
            N037:['电池温度','Bat. T'],             
                               
            N038:['第：','No.：'],
            N039:['共：','All：'],

            N060:['运行','Runing'],
            N061:['待机','Standy'],
            N062:['停机','Stoped'],
            N063:['故障','Fault'],
            N064:['初始状态','Initial'],
            N065:['紧急停机','EMG-Stop'],
            N066:['无通讯','Com fail'],

            N101:['状态','Status'],
            N102:['故障状态','Fault state'],
            N103:['母线侧电压','Bus bar V'],
            N104:['母线侧电流','Bus bar I'],
            N105:['蓄电池侧电压','Bat.V'],
            N106:['蓄电池侧电流','Bat.I'],
            N107:['模块1温度','Module 1# T'],
            N108:['模块2温度','Module 2# T'],    

            N111:['状态','Status'],
            N112:['故障状态','Fault state'],
            N113:['母线侧电压','Bus bar V'],
            N114:['母线侧电流','Bus bar I'],
            N115:['蓄电池侧电压','Bat.V'],
            N116:['蓄电池侧电流','Bat.I'],
            N117:['模块1温度','Module 1# T'],
            N118:['模块2温度','Module 2# T'],   

            N121:['状态','Status'],
            N122:['故障状态','Fault state'],
            N123:['母线侧电压','Bus bar V'],
            N124:['母线侧电流','Bus bar I'],
            N125:['蓄电池侧电压','Bat.V'],
            N126:['蓄电池侧电流','Bat.I'],
            N127:['模块1温度','Module 1# T'],
            N128:['模块2温度','Module 2# T'], 

            N131:['状态','Status'],
            N132:['故障状态','Fault state'],
            N133:['母线侧电压','Bus bar V'],
            N134:['母线侧电流','Bus bar I'],
            N135:['蓄电池侧电压','Bat.V'],
            N136:['蓄电池侧电流','Bat.I'],
            N137:['模块1温度','Module 1# T'],
            N138:['模块2温度','Module 2# T'],  

            N160:['停机','Stoped'],
            N161:['恒流充电','Const I charge'],
            N162:['恒流放电','Const I discharge'],
            N163:['恒功率充电','Const P charge'],
            N164:['恒功率放电','Const P discharge'],
            N165:['停机','Stoped'],
            N166:['待机','Standy'],
            N167:['紧急停机','EMG-Stop'],

            N170:['正常','Normal'],
            N171:['故障','Fault'],

            N500:['一共','Total '],
            N501:['页，共',' Pages, '],
            N502:['页，共',' Page, '],
            N503:['台',' Nums'],
            N504:['台',' Num']
        };
        var E_id=new Array(0,1,2,3,4,5,6);
        var E_name=new Array('60','61','62','63','64','65','66');

        var E2_id=new Array(0,1,2,3,4,5,6,7);
        var E2_name=new Array('160','161','162','163','164','165','166','167');   

        var E3_id=new Array(0,1);
        var E3_name=new Array('170','171');         

        //测试
        Json={ID_0x0301:85,ID_0x0070:1,
            ID_0x0071:6500,ID_0x0072:1000,ID_0x0073:5000,ID_0x0074:5000,ID_0x0075:50000,ID_0x0076:300,ID_0x0077:100,ID_0x0078:3,
            ID_0x0085:6500,ID_0x0086:1000,ID_0x0087:5000,ID_0x0088:5000,ID_0x0089:50000,ID_0x008A:300,ID_0x008B:100,ID_0x008C:5,
            ID_0x0099:6500,ID_0x009A:1000,ID_0x009B:5000,ID_0x009C:5000,ID_0x009D:50000,ID_0x009E:300,ID_0x009F:100,ID_0x00A0:6,
            ID_0x00AD:6500,ID_0x00AE:1000,ID_0x00AF:5000,ID_0x00B0:5000,ID_0x00B1:50000,ID_0x00B2:300,ID_0x00B3:100,ID_0x00B4:3,
            ID_0x00F1:6,ID_0x00F2:1,ID_0x00F3:6500,ID_0x00F4:1000,ID_0x00F5:7200,ID_0x00F6:500,ID_0x00F7:300,ID_0x00F8:290,
            ID_0x0101:3,ID_0x0102:1,ID_0x0103:6500,ID_0x0104:1000,ID_0x0105:7200,ID_0x0106:500,ID_0x0107:300,ID_0x0108:290,
            ID_0x0111:5,ID_0x0112:1,ID_0x0113:6500,ID_0x0114:1000,ID_0x0115:7200,ID_0x0116:500,ID_0x0117:300,ID_0x0118:290,
            ID_0x0121:7,ID_0x0122:0,ID_0x0123:6500,ID_0x0124:1000,ID_0x0125:7200,ID_0x0126:500,ID_0x0127:300,ID_0x0128:290,
            ID_0x0352:48,ID_0x038B:2};

        //获取串口PVS数据
        function Get_Dcdc_Index(index)
        {
            eval('var URL=\'s_017.html?0x'+(0+index).toString(16).toUpperCase()+'&time=\'+new Date();');
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);   
                    if(Json.ID_0x038B == 1)
                    {
                        $('ID_0x0071').innerHTML=(Json.ID_0x0071/10.0).toFixed(1);
                        $('ID_0x0072').innerHTML=(Json.ID_0x0072/10.0).toFixed(1);
                        $('ID_0x0073').innerHTML=(Json.ID_0x0073/10.0).toFixed(1);
                        $('ID_0x0074').innerHTML=(Json.ID_0x0074/10.0).toFixed(1);
                        $('ID_0x0075').innerHTML=(Json.ID_0x0075/10.0).toFixed(1);
                        $('ID_0x0076').innerHTML=(Json.ID_0x0076/10.0).toFixed(1);
                        $('ID_0x0077').innerHTML=(Json.ID_0x0077/10.0).toFixed(1);

                        $('ID_0x0085').innerHTML=(Json.ID_0x0085/10.0).toFixed(1);
                        $('ID_0x0086').innerHTML=(Json.ID_0x0086/10.0).toFixed(1);
                        $('ID_0x0087').innerHTML=(Json.ID_0x0087/10.0).toFixed(1);
                        $('ID_0x0088').innerHTML=(Json.ID_0x0088/10.0).toFixed(1);
                        $('ID_0x0089').innerHTML=(Json.ID_0x0089/10.0).toFixed(1);
                        $('ID_0x008A').innerHTML=(Json.ID_0x008A/10.0).toFixed(1);
                        $('ID_0x008B').innerHTML=(Json.ID_0x008B/10.0).toFixed(1);

                        $('ID_0x0099').innerHTML=(Json.ID_0x0099/10.0).toFixed(1);
                        $('ID_0x009A').innerHTML=(Json.ID_0x009A/10.0).toFixed(1);
                        $('ID_0x009B').innerHTML=(Json.ID_0x009B/10.0).toFixed(1);
                        $('ID_0x009C').innerHTML=(Json.ID_0x009C/10.0).toFixed(1);
                        $('ID_0x009D').innerHTML=(Json.ID_0x009D/10.0).toFixed(1);
                        $('ID_0x009E').innerHTML=(Json.ID_0x009E/10.0).toFixed(1);
                        $('ID_0x009F').innerHTML=(Json.ID_0x009F/10.0).toFixed(1);  
                        
                        //$('ID_0x00AD').innerHTML=(Json.ID_0x00AD/10.0).toFixed(1);
                        //$('ID_0x00AE').innerHTML=(Json.ID_0x00AE/10.0).toFixed(1);
                        //$('ID_0x00AF').innerHTML=(Json.ID_0x00AF/10.0).toFixed(1);
                        //$('ID_0x00B0').innerHTML=(Json.ID_0x00B0/10.0).toFixed(1);
                        //$('ID_0x00B1').innerHTML=(Json.ID_0x00B1/10.0).toFixed(1);
                        //$('ID_0x00B2').innerHTML=(Json.ID_0x00B2/10.0).toFixed(1);
                        //$('ID_0x00B3').innerHTML=(Json.ID_0x00B3/10.0).toFixed(1);      

                        for(var k=0;k<E_id.length;k++)if(Json.ID_0x0078==E_id[k])eval("$('ID_0x0078').innerHTML=lang.N0"+E_name[k]+"[language];");
                        for(var k=0;k<E_id.length;k++)if(Json.ID_0x008C==E_id[k])eval("$('ID_0x008C').innerHTML=lang.N0"+E_name[k]+"[language];");
                        for(var k=0;k<E_id.length;k++)if(Json.ID_0x00A0==E_id[k])eval("$('ID_0x00A0').innerHTML=lang.N0"+E_name[k]+"[language];");
                        //for(var k=0;k<E_id.length;k++)if(Json.ID_0x00B4==E_id[k])eval("$('ID_0x00B4').innerHTML=lang.N0"+E_name[k]+"[language];");  

                        if(Json.ID_0x0078 == 6) 
                        {
                             document.getElementById('ID_0x0078').style.color='#ff6820';
                             document.getElementById('ID_0x0078').style.fontWeight='bold';                    
                        }
                        else if(Json.ID_0x0078 == 3 || Json.ID_0x0078 == 5)
                        {
                            document.getElementById('ID_0x0078').style.color='#ff0000';
                            document.getElementById('ID_0x0078').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0078').style.fontWeight='normal';
                            document.getElementById('ID_0x0078').style.color='#000';
                        }

                        if(Json.ID_0x008C == 6) 
                        {
                             document.getElementById('ID_0x008C').style.color='#ff6820';
                             document.getElementById('ID_0x008C').style.fontWeight='bold';                    
                        }
                        else if(Json.ID_0x008C == 3 || Json.ID_0x008C == 5)
                        {
                            document.getElementById('ID_0x008C').style.color='#ff0000';
                            document.getElementById('ID_0x008C').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x008C').style.fontWeight='normal';
                            document.getElementById('ID_0x008C').style.color='#000';
                        }

                        if(Json.ID_0x00A0 == 6) 
                        {
                             document.getElementById('ID_0x00A0').style.color='#ff6820';
                             document.getElementById('ID_0x00A0').style.fontWeight='bold';                    
                        }
                        else if(Json.ID_0x00A0 == 3 || Json.ID_0x00A0 == 5)
                        {
                            document.getElementById('ID_0x00A0').style.color='#ff0000';
                            document.getElementById('ID_0x00A0').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x00A0').style.fontWeight='normal';
                            document.getElementById('ID_0x00A0').style.color='#000';
                        }
                    }
                    else if(Json.ID_0x038B == 2)
                    {
                        $('ID_0x00F3').innerHTML=(Json.ID_0x00F3/10.0).toFixed(1);
                        $('ID_0x00F4').innerHTML=(Json.ID_0x00F4/10.0).toFixed(1);
                        $('ID_0x00F5').innerHTML=(Json.ID_0x00F5/10.0).toFixed(1);
                        $('ID_0x00F6').innerHTML=(Json.ID_0x00F6/10.0).toFixed(1);
                        $('ID_0x00F7').innerHTML=(Json.ID_0x00F7/10.0).toFixed(1);
                        $('ID_0x00F8').innerHTML=(Json.ID_0x00F8/10.0).toFixed(1);

                        $('ID_0x0103').innerHTML=(Json.ID_0x0103/10.0).toFixed(1);
                        $('ID_0x0104').innerHTML=(Json.ID_0x0104/10.0).toFixed(1);
                        $('ID_0x0105').innerHTML=(Json.ID_0x0105/10.0).toFixed(1);
                        $('ID_0x0106').innerHTML=(Json.ID_0x0106/10.0).toFixed(1);
                        $('ID_0x0107').innerHTML=(Json.ID_0x0107/10.0).toFixed(1);
                        $('ID_0x0108').innerHTML=(Json.ID_0x0108/10.0).toFixed(1);

                        $('ID_0x0113').innerHTML=(Json.ID_0x0113/10.0).toFixed(1);
                        $('ID_0x0114').innerHTML=(Json.ID_0x0114/10.0).toFixed(1);
                        $('ID_0x0115').innerHTML=(Json.ID_0x0115/10.0).toFixed(1);
                        $('ID_0x0116').innerHTML=(Json.ID_0x0116/10.0).toFixed(1);
                        $('ID_0x0117').innerHTML=(Json.ID_0x0117/10.0).toFixed(1);
                        $('ID_0x0118').innerHTML=(Json.ID_0x0118/10.0).toFixed(1);  

                        $('ID_0x0123').innerHTML=(Json.ID_0x0123/10.0).toFixed(1);
                        $('ID_0x0124').innerHTML=(Json.ID_0x0124/10.0).toFixed(1);
                        $('ID_0x0125').innerHTML=(Json.ID_0x0125/10.0).toFixed(1);
                        $('ID_0x0126').innerHTML=(Json.ID_0x0126/10.0).toFixed(1);
                        $('ID_0x0127').innerHTML=(Json.ID_0x0127/10.0).toFixed(1);
                        $('ID_0x0128').innerHTML=(Json.ID_0x0128/10.0).toFixed(1);   

                        for(var k=0;k<E2_id.length;k++)if(Json.ID_0x00F1==E2_id[k])eval("$('ID_0x00F1').innerHTML=lang.N"+E2_name[k]+"[language];");  
                        for(var k=0;k<E2_id.length;k++)if(Json.ID_0x0101==E2_id[k])eval("$('ID_0x0101').innerHTML=lang.N"+E2_name[k]+"[language];");
                        for(var k=0;k<E2_id.length;k++)if(Json.ID_0x0111==E2_id[k])eval("$('ID_0x0111').innerHTML=lang.N"+E2_name[k]+"[language];");
                        for(var k=0;k<E2_id.length;k++)if(Json.ID_0x0121==E2_id[k])eval("$('ID_0x0121').innerHTML=lang.N"+E2_name[k]+"[language];");
                        for(var k=0;k<E3_id.length;k++)if(Json.ID_0x00F2==E3_id[k])eval("$('ID_0x00F2').innerHTML=lang.N"+E3_name[k]+"[language];"); 
                        for(var k=0;k<E3_id.length;k++)if(Json.ID_0x0102==E3_id[k])eval("$('ID_0x0102').innerHTML=lang.N"+E3_name[k]+"[language];"); 
                        for(var k=0;k<E3_id.length;k++)if(Json.ID_0x0112==E3_id[k])eval("$('ID_0x0112').innerHTML=lang.N"+E3_name[k]+"[language];"); 
                        for(var k=0;k<E3_id.length;k++)if(Json.ID_0x0122==E3_id[k])eval("$('ID_0x0122').innerHTML=lang.N"+E3_name[k]+"[language];"); 

                        if(Json.ID_0x00F1 == 7)
                        {
                            document.getElementById('ID_0x00F1').style.color='#ff0000';
                            document.getElementById('ID_0x00F1').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x00F1').style.fontWeight='normal';
                            document.getElementById('ID_0x00F1').style.color='#000';
                        }

                        if(Json.ID_0x0101 == 7)
                        {
                            document.getElementById('ID_0x0101').style.color='#ff0000';
                            document.getElementById('ID_0x0101').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0101').style.fontWeight='normal';
                            document.getElementById('ID_0x0101').style.color='#000';
                        }

                        if(Json.ID_0x0111 == 7)
                        {
                            document.getElementById('ID_0x0111').style.color='#ff0000';
                            document.getElementById('ID_0x0111').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0111').style.fontWeight='normal';
                            document.getElementById('ID_0x0111').style.color='#000';
                        }

                        if(Json.ID_0x0121 == 7)
                        {
                            document.getElementById('ID_0x0121').style.color='#ff0000';
                            document.getElementById('ID_0x0121').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0121').style.fontWeight='normal';
                            document.getElementById('ID_0x0121').style.color='#000';
                        }

                        if(Json.ID_0x00F2 == 1)
                        {
                            document.getElementById('ID_0x00F2').style.color='#ff0000';
                            document.getElementById('ID_0x00F2').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x00F2').style.fontWeight='normal';
                            document.getElementById('ID_0x00F2').style.color='#000';
                        }

                        if(Json.ID_0x0102 == 1)
                        {
                            document.getElementById('ID_0x0102').style.color='#ff0000';
                            document.getElementById('ID_0x0102').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0102').style.fontWeight='normal';
                            document.getElementById('ID_0x0102').style.color='#000';
                        }

                        if(Json.ID_0x0112 == 1)
                        {
                            document.getElementById('ID_0x0112').style.color='#ff0000';
                            document.getElementById('ID_0x0112').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0112').style.fontWeight='normal';
                            document.getElementById('ID_0x0112').style.color='#000';
                        }

                        if(Json.ID_0x0122 == 1)
                        {
                            document.getElementById('ID_0x0122').style.color='#ff0000';
                            document.getElementById('ID_0x0122').style.fontWeight='bold';
                        }
                        else
                        {
                            document.getElementById('ID_0x0122').style.fontWeight='normal';
                            document.getElementById('ID_0x0122').style.color='#000';
                        }
                    }                                          
                }
            };
            xmlhttp.open('GET',URL,true);
            xmlhttp.send();
            //alert(URL);   
        }    
        //整数补齐位数,希望输出的数字长度是固定的，假设为10，如果数字为123，则输出0000000123
        function PrefixInteger(num, length) {  return (num/Math.pow(10,length)).toFixed(length).substr(2);}    
        function ajax()
        {
            var URL='s_017.html?time='+new Date();
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);           
                    if(Json.ID_0x0301==0x55)language=0;else language=1;
                    for(var i=1;i<=29;i++){eval('$(\'N0'+(i<10?'0'+i:i)+'\').innerHTML=lang.N0'+(i<10?'0'+i:i)+'[language];');}
                    for(var i=101;i<=108;i++){eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');}  
                    for(var i=111;i<=118;i++){eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');} 
                    for(var i=121;i<=128;i++){eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');} 
                    for(var i=131;i<=138;i++){eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');}                               

                    if(Json.ID_0x038B == 1){
                        $('tab1_1').style.display='block';
                        $('tab1_2').style.display='block';
                        $('tab1_3').style.display='block';
                        //$('tab1_4').style.display='block';    
                        $('tab2_1').style.display='none';
                        $('tab2_2').style.display='none';
                        $('tab2_3').style.display='none';
                        $('tab2_4').style.display='none';  
                        $('tmode4').style.display='none';  
                        $('line').style.display='none';                              
                    }else if(Json.ID_0x038B == 2){
                        $('tab1_1').style.display='none';
                        $('tab1_2').style.display='none';
                        $('tab1_3').style.display='none';
                        //$('tab1_4').style.display='none';    
                        $('tab2_1').style.display='block';
                        $('tab2_2').style.display='block';
                        $('tab2_3').style.display='block';
                        $('tab2_4').style.display='block';   
                        $('tmode4').style.display='block'; 
                        $('line').style.display='block';                                            
                    }

                    if(Json.ID_0x0352==0){
                        $('pager').style.display='none';
                    }else{
                        $('pager').style.display='block';
                        mpager=new PagerView('pager',lang.N500[language],lang.N502[language],lang.N503[language]);
                    }
  
                    mpager.itemCount=Json.ID_0x0352;
                    mpager.size=1;
                    mpager.index=1; 
                    CurDcdc = mpager.index;
                    Get_Dcdc_Index(CurDcdc);               
                    mpager.onclick=function(index)
                    {  
                        CurDcdc = index;
                        //获取PCS储能逆变器信息
                        Get_Dcdc_Index(index);
                    };
                    //index显示更新
                    mpager.render();    
                }
            };
            xmlhttp.open('GET',URL,true);
            xmlhttp.send();
        }        
        function Init()
        {
            ajax();
            setInterval('Get_Dcdc_Index(CurDcdc)', 2000);
        }    
    </script>
</html>
