<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
	<head>
		<meta http-equiv='Content-Type' content='text/html; charset=GB2312'/>
		<link type='text/css' href='c_000.css' rel='stylesheet'/>
		<script type='text/javascript'>
            var $=function(o){return document.getElementById(o);};
            function lang_init_ex(st,end){for(var i=st;i<=end;i++)eval('$(\'N'+(i<10?'0'+i:i)+'\').innerHTML=lang.N'+(i<10?'0'+i:i)+'[language];');}
            function show_tip_ex(id, obj){eval('$(\'tip'+id+'\').innerHTML=obj;');}
            function show_T(tid)
            {
                var str='';
                str+="<div class='title' style='width:90%;'><div class='r1 color'></div><div class='r2 color'></div><div class='r3 color'></div><div class='r4 color'></div>";
                str+="<div class='content color'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 color'></div><div class='r3 color'></div><div class='r2 color'></div><div class='r1 color'></div></div><div class='blank'></div>";
                document.write(str);
            }
            function show_sT(tid)
            {
                var str='';
                str+="<div class='title' style='width:90%;'><div class='subtitle'><div class='r1 subcolor'></div><div class='r2 subcolor'></div><div class='r3 subcolor'></div><div class='r4 subcolor'></div>";
                str+="<div class='content subcolor subcontent'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 subcolor'></div><div class='r3 subcolor'></div><div class='r2 subcolor'></div><div class='r1 subcolor'></div></div><div class='line_short'></div></div>";
                document.write(str);
            }
            function show_sT_ex(tid, id)
            {
                var str='';
                str+="<div class='title' id='"+id+"' style='display:none;width:90%'><div class='subtitle'><div class='r1 subcolor'></div><div class='r2 subcolor'></div><div class='r3 subcolor'></div><div class='r4 subcolor'></div>";
                str+="<div class='content subcolor subcontent'><span id='"+tid+"'></span></div>";
                str+="<div class='r4 subcolor'></div><div class='r3 subcolor'></div><div class='r2 subcolor'></div><div class='r1 subcolor'></div></div><div class='line_short'></div></div>";
                document.write(str);
            }
            function sendHttpReq(url, successFn)
            {
                //alert(url);   
                var xmlhttp;
                if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
                else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
                xmlhttp.onreadystatechange=function()
                {
                    if(xmlhttp.readyState==4 && xmlhttp.status==200)
                    {
                        if(xmlhttp.responseText=='1'){successFn();}
                    }
                };
                xmlhttp.open('GET',url,true);
                xmlhttp.send();
            }
        </script>
		<style type='text/css'>
			tr{height:27px;}
			.td1{padding-left:40px;text-align:left;}
			.td2{text-align:left;}
			.td3{padding-right:40px;text-align:right;}
			.txt{width:50px;text-align:right;}
		</style>
	</head>
	<body onload='Init()'>
		<script type='text/javascript'>
			show_T('N01');
			show_sT('N02');
		</script>
        <!-- 界面选择 -->
        <table width='90%' border='0'>
            <tr>
              <td width='30%' class='td1 odd'><input name='SalveDevice-Sel' type='checkbox' id='Device-PCS'/><span id='N03'></span></td>
              <td width='30%' class='td1 odd'><input name='SalveDevice-Sel' type='checkbox' id='Device-PV'/><span id='N04'></span></td>
              <td width='30%' class='td1 odd'><input name='SalveDevice-Sel' type='checkbox' id='Device-DCDC'/><span id='N05'></span></td>
            </tr>
            <tr>
              <td width='30%' class='td1 even' style='display:block;'><input name='SalveDevice-Sel' type='checkbox' id='Device-PVS'/><span id='N06'></span></td>
              <td width='30%' class='td1 even'><input name='SalveDevice-Sel' type='checkbox' id='Device-BMS'/><span id='N07'></span></td>
              <td width='30%' class='td1 even'><input name='SalveDevice-Sel' type='checkbox' id='Device-Ammeter'/><span id='N08'></span></td>
            </tr>
            <tr>
              <td width='30%' class='td1 odd'><input name='SalveDevice-Sel' type='checkbox' id='Device-ENV'/><span id='N09'></span></td>
              <td width='30%' class='td1 odd'><span></span></td>
              <td width='30%' class='td1 odd'><span></span></td>
            </tr>
            <tr style='display:none;'>
                <td width='30%' class='td1 even'><input name='SalveDevice-Sel' type='checkbox' id='Device-RealTimeMonitor'/><span id='N32'></span></td>
            	<td width='30%' class='td1 even'><input name='SalveDevice-Sel' type='checkbox' id='Device-BetteryControl' style='display:none;'/><span id='N33' style='display:none;'></span></td>
                <td width='30%' class='td1 even'><span></span></td>
            </tr>
        </table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip1'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn1' style='display:block;'><span id='N400'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='blank'></div>  
        <!-- 分时段控制使能 -->
        <script type='text/javascript'>
            show_sT('N12');
        </script>
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='TIME-SLOT-EN' type='radio' value='0' id='T-DIS'/><span id='N13'></span></td>
                <td width='30%' class='td1 odd'><input name='TIME-SLOT-EN' type='radio' value='1' id='T-HOUR'/><span id='N14'></span></td>
                <td width='30%' class='td1 odd'><input name='TIME-SLOT-EN' type='radio' value='2' id='T-WEEK'/><span id='N34'></span></td>
            </tr>
        </table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip2'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn2' style='display:block;'><span id='N402'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
		<!-- 电池类型 -->
		<script type='text/javascript'>
			show_sT('N15');
		</script>
		<table width='90%' border='0'>
			<tr>
			  <td width='30%' class='td1 odd'><input name='BATTERY-TYPE' type='radio' value='0' id='B-NONE'/><span id='N16'></span></td>
			  <td width='30%' class='td1 odd'><input name='BATTERY-TYPE' type='radio' value='1' id='B-TYPE1'/><span id='N17'></span></td>
			  <td width='30%' class='td1 odd'><input name='BATTERY-TYPE' type='radio' value='2' id='B-TYPE2'/><span id='N18'></span></td>
            </tr>			
		</table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip3'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn3' style='display:block;'><span id='N403'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
		<div class='btm_blank'></div>
		<!-- DCDC类型 -->
		<script type='text/javascript'>
			show_sT('N19');
		</script>
		<table width='90%' border='0'>
			<tr>
				<td width='30%' class='td1 odd'><input name='DCDC-Type' type='radio' value='0' id='DCDC-DIS'/><span id='N20'></span></td>
                <td width='30%' class='td1 odd'><input name='DCDC-Type' type='radio' value='1' id='DCDC-OneWay'/><span id='N21'></span></td>
                <td width='30%' class='td1 odd'><input name='DCDC-Type' type='radio' value='2' id='DCDC-BothWay'/><span id='N22'></span></td>
			</tr>
		</table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip4'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn4' style='display:block;'><span id='N404'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
		<div class='btm_blank'></div>
		<!-- PCS通讯方式 -->
		<script type='text/javascript'>
			show_sT('N26');
		</script>
		<table width='90%' border='0'>
			<tr>
				<td width='30%' class='td1 odd'><input name='PCS-COM-MODE' type='radio' value='0' id='PCS-UART'/><span id='N27'></span></td>
				<td width='30%' class='td1 odd'><input name='PCS-COM-MODE' type='radio' value='1' id='PCS-NET'/><span id='N28'></span></td>
			</tr>
		</table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip6'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn6' style='display:block;'><span id='N406'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
		<div class='btm_blank'></div>
        <!-- 配电功能使能 -->
        <script type='text/javascript'>
            show_sT('N29');
        </script>
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='Distribution-EN' type='radio' value='85' id='D-DIS'/><span id='N30'></span></td>
                <td width='30%' class='td1 odd'><input name='Distribution-EN' type='radio' value='170' id='D-EN'/><span id='N31'></span></td>
            </tr>
        </table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip7'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn7' style='display:block;'><span id='N407'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
        <!-- 均衡控制使能 -->
        <script type='text/javascript'>
            show_sT('N35');
        </script>
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='Balance-EN' type='radio' value='85' id='B-DIS'/><span id='N36'></span></td>
                <td width='30%' class='td1 odd'><input name='Balance-EN' type='radio' value='170' id='B-EN'/><span id='N37'></span></td>
            </tr>
        </table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip8'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn8' style='display:block;'><span id='N408'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
        <!-- PCS离网启动策略 -->
        <script type='text/javascript'>
            show_sT('N38');
        </script>
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='OFFGRID-POLICY' type='radio' value='0' id='ALL-NORMAL'/><span id='N39'></span></td>
                <td width='30%' class='td1 odd'><input name='OFFGRID-POLICY' type='radio' value='1' id='PART-NORMAL'/><span id='N40'></span></td>
            </tr>
        </table>
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip9'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn9' style='display:block;'><span id='N409'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
        <!-- PV通讯方式 -->
        <script type='text/javascript'>
            show_sT('N41');
        </script>  
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='PV-COM-MODE' type='radio' value='0' id='PV-UART'/><span id='N42'></span></td>
                <td width='30%' class='td1 odd'><input name='PV-COM-MODE' type='radio' value='1' id='PV-NET'/><span id='N43'></span></td>
            </tr>
        </table> 
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip10'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn10' style='display:block;'><span id='N410'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
        <!-- 电表协议 -->
        <script type='text/javascript'>
            show_sT('N44');
        </script>  
        <table width='90%' border='0'>
            <tr>
                <td width='30%' class='td1 odd'><input name='AMMETER-PROTOCOL' type='radio' value='0' id='AMMETER-MODBUS'/><span id='N45'></span></td>
                <td width='30%' class='td1 odd'><input name='AMMETER-PROTOCOL' type='radio' value='1' id='AMMETER-DLT645'/><span id='N46'></span></td>
            </tr>
        </table> 
        <table width='90%' border='0'>
            <tr>
                <td width='50%' class='even tip'><span id='tip11'>&nbsp;</span></td>
                <!-- 保存 -->
                <td width='50%' align='right' class='even'><button class='btn' onclick='doSubmit(this)' id='btn11' style='display:block;'><span id='N411'>Save</span></button></td>
            </tr>
        </table>
        <div class='line_long'></div>
        <div class='btm_blank'></div>
		<div id='trans'></div>
		<!--[if IE 6]><script type='text/javascript'>document.execCommand('BackgroundImageCache',false,true);</script><![endif]-->
	</body>
    <script type='text/javascript'>
        window.history.forward(1);
        var language=0;
        var Json; 
        var lang=
        {
            N01:['功能设置','Function Settings'],
            N02:['界面','Interface'],
            N03:['储能逆变器','PCS'],
            N04:['光伏逆变器','PV'],
            N05:['光伏控制器','DCDC'],
            N06:['光伏汇流箱','PVS'],
            N07:['电池管理系统','BMS'],
            N08:['电表','Ammeter'],
            N09:['环境监测仪','Env-Detector'],

            N12:['分时段控制使能','Time Slot Enbale'],
            N13:['禁止','Disable'],
            N14:['按小时','By Hour'], 
         	N15:['电池类型','Battery Type'],
         	N16:['禁止','Disable'],
         	N17:['68Ah','68Ah'],
         	N18:['94Ah','94Ah'],
         	N19:['DCDC类型','DCDC Type'],
            N20:['禁止','Disable'],
            N21:['单向DCDC','One-way DCDC'],
            N22:['双向DCDC','Bothway DCDC'],

         	N26:['PCS通讯模式','PCS Comm Mode'],
            N27:['串口','Uart'],
            N28:['网口','TCP/IP'],
            N29:['配电使能','Distribution Enbale'],
            N30:['禁止','Disable'],
            N31:['使能','Enable'],          
            N32:['实时监控','RealTime Monitor'],
            N33:['电池控制','Battery Control'], 
            N34:['按星期','By Week'],  
            N35:['均衡控制使能','Balance Control Enbale'],
            N36:['禁止','Disable'],
            N37:['使能','Enable'],
            N38:['PCS离网启动策略','PCS OFF-Grid Start Policy'],
            N39:['全部正常','All Normal'],
            N40:['部分正常','Normal Part'],
            N41:['PV通讯模式','PV Comm Mode'],
            N42:['串口','Uart'],
            N43:['网口','TCP/IP'],
            N44:['电表协议','Ammeter Protocol'],
            N45:['MODBUS','MODBUS'],
            N46:['DL/T645','DL/T645'],

            N400:['设&nbsp;&nbsp;置','Set'], 
            N401:['设&nbsp;&nbsp;置','Set'], 
            N402:['设&nbsp;&nbsp;置','Set'],  
            N403:['设&nbsp;&nbsp;置','Set'], 
            N404:['设&nbsp;&nbsp;置','Set'],  
            N405:['设&nbsp;&nbsp;置','Set'], 	          
            N406:['设&nbsp;&nbsp;置','Set'],  
            N407:['设&nbsp;&nbsp;置','Set'], 
            N408:['设&nbsp;&nbsp;置','Set'], 
            N409:['设&nbsp;&nbsp;置','Set'], 
            N410:['设&nbsp;&nbsp;置','Set'], 
            N411:['设&nbsp;&nbsp;置','Set'], 

            N499:['设置成功！','Set successfully!'],
            N500:['设置失败！','Set Failed!'],
            N501:['格式错误！','Format error!'],
            N502:['范围错误！','Range error!']      
        };
        function Init()
        {
            var URL='s_023.html?time='+new Date();
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {            
                    //测试
                    Json={ID_0x0301:85,ID_0x0380:0,ID_0x0381:0,ID_0x0382:0,ID_0x0383:0,ID_0x0384:100,ID_0x0385:0,ID_0x0386:0,ID_0x0387:1,
                        ID_0x0388:1,ID_0x0389:1,ID_0x038A:1,ID_0x038B:0,ID_0x038C:0xAA,ID_0x038D:1,ID_0x038E:0xAA,
                        ID_0x0390:1,ID_0x0391:1,ID_0x0392:1,ID_0x0393:1,ID_0x0394:1,ID_0x0395:1,ID_0x0396:1,ID_0x0397:1,ID_0x039A:1,
                        ID_0x0370:0x55,ID_0x0371:0,ID_0x0372:2,ID_0x0373:2,ID_0x036F:0,
                        ID_0x0282:34};

                   	//eval('Json='+xmlhttp.responseText);				

    				if(Json.ID_0x0301==0x55)language=0;else language=1;
                    //初始化语言
    				lang_init_ex(1,9);
                    lang_init_ex(12,22);
                    lang_init_ex(26,46);
                    lang_init_ex(400,400); 
                    lang_init_ex(402,404);
                    lang_init_ex(406,411);

    				doSetValue(Json);

    				//user用户不能配置，install用户可以配置
    				if(Json.ID_0x0282==0x11)
    				{
    					$('btn1').style.display='none';
    					$('trans').style.zIndex=9999;
    				}
    				else
    				{
    					$('btn1').style.display='inline';
    					$('trans').style.zIndex=-9999;
    				}
                }
            };
            xmlhttp.open('GET',URL,true);
            xmlhttp.send();
        }
        function read_back(addr)
        {
            var url='s_023.html?';
            if(addr==0x038A){url=url+'&0x038A'+'&0x0394';}
            if(addr==0x038B){url=url+'&0x038B'+'&0x0392';}
            if(addr==0x038C){url=url+'&0x038C'+'&0x0395';}
            if(addr==0x0390){url=url+'&0x0390'+'&0x0391'+'&0x0392'+'&0x0393'+'&0x0394'+'&0x0395'+'&0x0396'+'&0x0397'+'&0x0398'+'&0x0399'+'&0x039A';}
            url=url+'&time='+new Date();

            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText); 
                    if(addr == 0x0390)
                    {
                        var pr_d_pcs=0,fe_d_pcs=0;
                        var pr_d_pv=0,fe_d_pv=0;
                        var pr_d_dcdc=0,fe_d_dcdc=0;
                        var pr_d_bms=0,fe_d_bms=0;
                        var pr_d_ammeter=0,fe_d_ammeter=0;
                        var pr_d_pvs=0,fe_d_pvs=0;
                        var pr_d_realtime=0,fe_d_realtime=0;
                        var pr_d_env=0,fe_d_env=0;
                        if($('Device-PCS').checked){pr_d_pcs=1;}else{pr_d_pcs=0;}
                        if($('Device-PV').checked){pr_d_pv=1;}else{pr_d_pv=0;}
                        if($('Device-DCDC').checked){pr_d_dcdc=1;}else{pr_d_dcdc=0;}
                        if($('Device-PVS').checked){pr_d_pvs=1;}else{pr_d_pvs=0;}
                        if($('Device-BMS').checked){pr_d_bms=1;}else{pr_d_bms=0;} 
                        if($('Device-Ammeter').checked){pr_d_ammeter=1;}else{pr_d_ammeter=0;}
                        if($('Device-RealTimeMonitor').checked){pr_d_realtime=1;}else{pr_d_realtime=0;}
                        if($('Device-ENV').checked){pr_d_env=1;}else{pr_d_env=0;}
                        fe_d_pcs = Json.ID_0x0390;
                        fe_d_pv = Json.ID_0x0391;
                        fe_d_dcdc = Json.ID_0x0392;
                        fe_d_pvs = Json.ID_0x0393;
                        fe_d_bms = Json.ID_0x0394;
                        fe_d_ammeter = Json.ID_0x0395;
                        fe_d_realtime = Json.ID_0x0396;
                        fe_d_env = Json.ID_0x039A;
                        show_tip_ex(1,'&nbsp;');
                        if(pr_d_pcs!=fe_d_pcs || pr_d_pv!=fe_d_pv || pr_d_dcdc!=fe_d_dcdc || pr_d_pvs!=fe_d_pvs || pr_d_bms!=fe_d_bms || pr_d_ammeter!=fe_d_ammeter || pr_d_realtime!=fe_d_realtime || pr_d_env!=fe_d_env){
                            setTimeout('show_tip_ex(1,lang.N500[language])',500);
                        }
                        else {setTimeout('show_tip_ex(1,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(1,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x0389)
                    {
                        var pr=0,fe=0;
                        if($('T-DIS').checked){pr=$('T-DIS').value;}
                        else if($('T-HOUR').checked){pr=$('T-HOUR').value;}
                        else if($('T-WEEK').checked){pr=$('T-WEEK').value;}
                        fe=Json.ID_0x0389;
                        if(pr!=fe){
                            if(Json.ID_0x0389==0)
                            {
                                $('T-DIS').checked=true;
                                $('T-HOUR').checked=false;
                                $('T-WEEK').checked=false;
                            }
                            else if(Json.ID_0x0389==1)
                            {
                                $('T-DIS').checked=false;
                                $('T-HOUR').checked=true;
                                $('T-WEEK').checked=false;              
                            }
                            else if(Json.ID_0x0389==2)
                            {
                                $('T-DIS').checked=false;
                                $('T-HOUR').checked=false;  
                                $('T-WEEK').checked=true;             
                            }
                        }
                        show_tip_ex(2,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(2,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(2,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(2,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x038A)
                    {
                        if(Json.ID_0x0394==0){$('Device-BMS').checked=false;}else{$('Device-BMS').checked=true;}
                        var pr=0,fe=0;
                        if($('B-NONE').checked){pr=$('B-NONE').value;} 
                        else if($('B-TYPE1').checked){pr=$('B-TYPE1').value;} 
                        else if($('B-TYPE2').checked){pr=$('B-TYPE2').value;} 
                        fe=Json.ID_0x038A;
                        if(pr!=fe){
                            if(Json.ID_0x038A==0)
                            {
                                $('Device-BMS').disabled=true;
                                $('B-NONE').checked=true;
                                $('B-TYPE1').checked=false;
                                $('B-TYPE2').checked=false;
                            }
                            else if(Json.ID_0x038A==1)
                            {
                                $('Device-BMS').disabled=false;
                                $('B-NONE').checked=false;
                                $('B-TYPE1').checked=true;
                                $('B-TYPE2').checked=false;
                            }
                            else if(Json.ID_0x038A==2)
                            {
                                $('Device-BMS').disabled=false;
                                $('B-NONE').checked=false;
                                $('B-TYPE1').checked=false;
                                $('B-TYPE2').checked=true;          
                            } 
                        }
                        show_tip_ex(3,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(3,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(3,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(3,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x038B)
                    {
                        if(Json.ID_0x0392==0){$('Device-DCDC').checked=false;}else{$('Device-DCDC').checked=true;}
                        var pr=0,fe=0;
                        if($('DCDC-DIS').checked){pr=$('DCDC-DIS').value;}   
                        else if($('DCDC-OneWay').checked){pr=$('DCDC-OneWay').value;}
                        else if($('DCDC-BothWay').checked){pr=$('DCDC-BothWay').value;}
                        fe=Json.ID_0x038B;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x038B==0)
                            {
                                $('Device-DCDC').disabled=true;
                                $('DCDC-DIS').checked=true;
                                $('DCDC-OneWay').checked=false;
                                $('DCDC-BothWay').checked=false;
                            }
                            else if(Json.ID_0x038B==1)
                            {
                                $('Device-DCDC').disabled=false;
                                $('DCDC-DIS').checked=false;
                                $('DCDC-OneWay').checked=true;
                                $('DCDC-BothWay').checked=false;            
                            } 
                            else if(Json.ID_0x038B==2)
                            {
                                $('Device-DCDC').disabled=false;
                                $('DCDC-DIS').checked=false;
                                $('DCDC-OneWay').checked=false;
                                $('DCDC-BothWay').checked=true;            
                            } 
                        }
                        show_tip_ex(4,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(4,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(4,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(4,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x038D)
                    {
                        var pr=0,fe=0;
                        if($('PCS-UART').checked){pr=$('PCS-UART').value;}    
                        else if($('PCS-NET').checked){pr=$('PCS-NET').value;}
                        fe=Json.ID_0x038D;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x038D==0)
                            {
                                $('PCS-UART').checked=true;
                                $('PCS-NET').checked=false;
                            }
                            else if(Json.ID_0x038D==1)
                            {
                                $('PCS-UART').checked=false;
                                $('PCS-NET').checked=true;              
                            }  
                        }
                        show_tip_ex(6,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(6,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(6,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(6,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x038E)
                    {
                        var pr=0,fe=0;
                        if($('D-DIS').checked){pr=$('D-DIS').value;}    
                        else if($('D-EN').checked){pr=$('D-EN').value;}
                        fe=Json.ID_0x038E;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x038E==0x55)
                            {
                                $('D-DIS').checked=true;
                                $('D-EN').checked=false;
                            }
                            else if(Json.ID_0x038E==0xAA)
                            {
                                $('D-DIS').checked=false;
                                $('D-EN').checked=true;              
                            }
                        }
                        show_tip_ex(7,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(7,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(7,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(7,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x0370)
                    {
                        var pr=0,fe=0;
                        if($('B-DIS').checked){pr=$('B-DIS').value;}    
                        else if($('B-EN').checked){pr=$('B-EN').value;}
                        fe=Json.ID_0x0370;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x0370==0x55)
                            {
                                $('B-DIS').checked=true;
                                $('B-EN').checked=false; 
                            }
                            else if(Json.ID_0x0370==0xAA)
                            {
                                $('B-DIS').checked=false;
                                $('B-EN').checked=true;              
                            }
                        }
                        show_tip_ex(8,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(8,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(8,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(8,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x0371)
                    {
                        var pr=0,fe=0;
                        if($('ALL-NORMAL').checked){pr=$('ALL-NORMAL').value;}    
                        else if($('PART-NORMAL').checked){pr=$('PART-NORMAL').value;}
                        fe=Json.ID_0x0371;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x0371==0)
                            {
                                $('ALL-NORMAL').checked=true;
                                $('PART-NORMAL').checked=false; 
                            }
                            else if(Json.ID_0x0371==1)
                            {
                                $('ALL-NORMAL').checked=false;
                                $('PART-NORMAL').checked=true;              
                            } 
                        }
                        show_tip_ex(9,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(9,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(9,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(9,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x0387)
                    {
                        var pr=0,fe=0;
                        if($('PV-UART').checked){pr=$('PV-UART').value;}    
                        else if($('PV-NET').checked){pr=$('PV-NET').value;}
                        fe=Json.ID_0x0387;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x0387==0)
                            {
                                $('PV-UART').checked=true;
                                $('PV-NET').checked=false;
                            }
                            else if(Json.ID_0x0387==1)
                            {
                                $('PV-UART').checked=false;
                                $('PV-NET').checked=true;              
                            } 
                        }
                        show_tip_ex(10,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(10,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(10,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(10,\'&nbsp;\')',2500);
                    }
                    else if(addr == 0x036F)
                    {
                        var pr=0,fe=0;
                        if($('AMMETER-MODBUS').checked){pr=$('AMMETER-MODBUS').value;}    
                        else if($('AMMETER-DLT645').checked){pr=$('AMMETER-DLT645').value;}
                        fe=Json.ID_0x036F;
                        if(pr!=fe)
                        {
                            if(Json.ID_0x036F == 0)
                            {
                                $('AMMETER-MODBUS').checked=true;
                                $('AMMETER-DLT645').checked=false;
                            }
                            else if(Json.ID_0x036F == 1)
                            {
                                $('AMMETER-MODBUS').checked=false;
                                $('AMMETER-DLT645').checked=true;
                            } 
                        }
                        show_tip_ex(11,'&nbsp;');
                        if(pr!=fe){setTimeout('show_tip_ex(11,lang.N500[language])',500);}
                        else {setTimeout('show_tip_ex(11,lang.N499[language])',500);}
                        setTimeout('show_tip_ex(11,\'&nbsp;\')',2500);
                    }
                }
            };
            xmlhttp.open('GET',url,true);
            xmlhttp.send();  
        }
        function doSubmit(obj)
        {
            var Device_PCS,Device_PV,Device_DCDC,Device_PVS,Device_BMS,Device_Ammeter,Device_RealTimeMonitor,Device_env,TimeSolt,BatteryType,DCDC_comm,Ammeter_comm,BMS_comm,PCS_comm,PV_comm,Ammeter_Protocol,BatteryControl,Distribution_En,Balance_EN,Offgrid_St,pcs_baud,pv_baud;

            var URL='a_023.html?';
            switch(obj.id)
            {
            	case 'btn1': 
		            if($('Device-PCS').checked){Device_PCS=1;}else{Device_PCS=0;}
		            if($('Device-PV').checked){Device_PV=1;}else{Device_PV=0;}
		            if($('Device-DCDC').checked){Device_DCDC=1;}else{Device_DCDC=0;}
		            if($('Device-PVS').checked){Device_PVS=1;}else{Device_PVS=0;}
		            if($('Device-BMS').checked){Device_BMS=1;}else{Device_BMS=0;} 
		            if($('Device-Ammeter').checked){Device_Ammeter=1;}else{Device_Ammeter=0;}
                    if($('Device-RealTimeMonitor').checked){Device_RealTimeMonitor=1;}else{Device_RealTimeMonitor=0;}
                    //if($('Device-BetteryControl').checked){BatteryControl=1;}else{BatteryControl=0;}
                    if($('Device-ENV').checked){Device_env=1;}else{Device_env=0;}
		            URL=URL+'&0x0390='+Device_PCS;
		            URL=URL+'&0x0391='+Device_PV;
		            URL=URL+'&0x0392='+Device_DCDC;
		            URL=URL+'&0x0393='+Device_PVS;
		            URL=URL+'&0x0394='+Device_BMS;
		            URL=URL+'&0x0395='+Device_Ammeter;
                    URL=URL+'&0x0396='+Device_RealTimeMonitor;
                    URL=URL+'&0x0397='+BatteryControl;
                    URL=URL+'&0x039A='+Device_env;
                    readBack=0x0390;
            	break;
                case 'btn2': 
                    if($('T-DIS').checked){TimeSolt=$('T-DIS').value;}
                    else if($('T-HOUR').checked){TimeSolt=$('T-HOUR').value;}
                    else if($('T-WEEK').checked){TimeSolt=$('T-WEEK').value;}
                    URL=URL+'&0x0389='+TimeSolt;
                    readBack=0x0389;  
                break;
            	case 'btn3': 
                    var bms_show;
       				if($('B-NONE').checked){BatteryType=$('B-NONE').value;bms_show=0;}	
					else if($('B-TYPE1').checked){BatteryType=$('B-TYPE1').value;bms_show=1;} 
					else if($('B-TYPE2').checked){BatteryType=$('B-TYPE2').value;bms_show=1;} 
					URL=URL+'&0x038A='+BatteryType+'&0x0394='+bms_show;
                    readBack=0x038A; 
            	break;
            	case 'btn4': 
                    var dcdc_show;
 					if($('DCDC-DIS').checked){DCDC_comm=$('DCDC-DIS').value;dcdc_show=0;}	
					else if($('DCDC-OneWay').checked){DCDC_comm=$('DCDC-OneWay').value;dcdc_show=1;}
                    else if($('DCDC-BothWay').checked){DCDC_comm=$('DCDC-BothWay').value;dcdc_show=1;}
            		URL=URL+'&0x038B='+DCDC_comm+'&0x0392='+dcdc_show;
                    readBack=0x038B; 
            	break;
            	case 'btn5': 
            	break;
            	case 'btn6': 
			 		if($('PCS-UART').checked){PCS_comm=$('PCS-UART').value;}	
					else if($('PCS-NET').checked){PCS_comm=$('PCS-NET').value;}
					URL=URL+'&0x038D='+PCS_comm;
                    readBack=0x038D; 
            	break;
                case 'btn7':
                    if($('D-DIS').checked){Distribution_En=$('D-DIS').value;}    
                    else if($('D-EN').checked){Distribution_En=$('D-EN').value;}
                    URL=URL+'&0x038E='+Distribution_En;
                    readBack=0x038E; 
                break;
                case 'btn8':
                    if($('B-DIS').checked){Balance_EN=$('B-DIS').value;}    
                    else if($('B-EN').checked){Balance_EN=$('B-EN').value;}
                    URL=URL+'&0x0370='+Balance_EN;
                    readBack=0x0370; 
                break;
                case 'btn9':
                    if($('ALL-NORMAL').checked){Offgrid_St=$('ALL-NORMAL').value;}    
                    else if($('PART-NORMAL').checked){Offgrid_St=$('PART-NORMAL').value;}
                    URL=URL+'&0x0371='+Offgrid_St;
                    readBack=0x0371; 
                break;
                case 'btn10': 
                    if($('PV-UART').checked){PV_comm=$('PV-UART').value;}    
                    else if($('PV-NET').checked){PV_comm=$('PV-NET').value;}
                    URL=URL+'&0x0387='+PV_comm;
                    readBack=0x0387; 
                break;
                case 'btn11': 
                    if($('AMMETER-MODBUS').checked){Ammeter_Protocol=$('AMMETER-MODBUS').value;}    
                    else if($('AMMETER-DLT645').checked){Ammeter_Protocol=$('AMMETER-DLT645').value;}
                    URL=URL+'&0x036F='+Ammeter_Protocol;
                    readBack=0x036F; 
                break;
            	default:break;
            }
            URL=URL+'&time='+new Date();
            //alert(URL);

            function success()
            {
    			setTimeout('read_back('+readBack+')', 100);         			
            }

            //测试
            success();  

			sendHttpReq(URL, success);
        }
        function doSetValue(Json)
        {
            //从设备设置
            if(Json.ID_0x0390==0){$('Device-PCS').checked=false;}else{$('Device-PCS').checked=true;}
            if(Json.ID_0x0391==0){$('Device-PV').checked=false;}else{$('Device-PV').checked=true;}
            if(Json.ID_0x0392==0){$('Device-DCDC').checked=false;}else{$('Device-DCDC').checked=true;}
            if(Json.ID_0x0393==0){$('Device-PVS').checked=false;}else{$('Device-PVS').checked=true;}
            if(Json.ID_0x0394==0){$('Device-BMS').checked=false;}else{$('Device-BMS').checked=true;}
            if(Json.ID_0x0395==0){$('Device-Ammeter').checked=false;}else{$('Device-Ammeter').checked=true;}
            if(Json.ID_0x0396==0){$('Device-RealTimeMonitor').checked=false;}else{$('Device-RealTimeMonitor').checked=true;}
            //if(Json.ID_0x0397==0){$('Device-BetteryControl').checked=false;}else{$('Device-BetteryControl').checked=true;}
            if(Json.ID_0x039A==0){$('Device-ENV').checked=false;}else{$('Device-ENV').checked=true;}

        	//分段控制使能
        	if(Json.ID_0x0389==0)
        	{
        		$('T-DIS').checked=true;
        		$('T-HOUR').checked=false;
                $('T-WEEK').checked=false;
        	}
        	else if(Json.ID_0x0389==1)
        	{
         		$('T-DIS').checked=false;
        		$('T-HOUR').checked=true;
                $('T-WEEK').checked=false;      		
        	}
            else if(Json.ID_0x0389==2)
            {
                $('T-DIS').checked=false;
                $('T-HOUR').checked=false;  
                $('T-WEEK').checked=true;             
            }             

        	//电池类型
        	if(Json.ID_0x038A==0)
        	{
                $('Device-BMS').disabled=true;
        		$('B-NONE').checked=true;
        		$('B-TYPE1').checked=false;
        		$('B-TYPE2').checked=false;
        	}
        	else if(Json.ID_0x038A==1)
        	{
                $('Device-BMS').disabled=false;
        		$('B-NONE').checked=false;
        		$('B-TYPE1').checked=true;
        		$('B-TYPE2').checked=false;
        	}
        	else if(Json.ID_0x038A==2)
        	{
                $('Device-BMS').disabled=false;
        		$('B-NONE').checked=false;
        		$('B-TYPE1').checked=false;
        		$('B-TYPE2').checked=true;   		
        	}  

        	//DCDC类型
        	if(Json.ID_0x038B==0)
        	{
                $('Device-DCDC').disabled=true;
        		$('DCDC-DIS').checked=true;
        		$('DCDC-OneWay').checked=false;
                $('DCDC-BothWay').checked=false;
        	}
        	else if(Json.ID_0x038B==1)
        	{
                $('Device-DCDC').disabled=false;
                $('DCDC-DIS').checked=false;
                $('DCDC-OneWay').checked=true;
                $('DCDC-BothWay').checked=false;    		
        	} 
            else if(Json.ID_0x038B==2)
            {
                $('Device-DCDC').disabled=false;
                $('DCDC-DIS').checked=false;
                $('DCDC-OneWay').checked=false;
                $('DCDC-BothWay').checked=true;            
            } 

         	//PCS通讯模式
        	if(Json.ID_0x038D==0)
        	{
        		$('PCS-UART').checked=true;
        		$('PCS-NET').checked=false;
        	}
        	else if(Json.ID_0x038D==1)
        	{
                $('PCS-UART').checked=false;
                $('PCS-NET').checked=true;      		
        	}  

            //配电使能
            if(Json.ID_0x038E==0x55)
            {
                $('D-DIS').checked=true;
                $('D-EN').checked=false;
            }
            else if(Json.ID_0x038E==0xAA)
            {
                $('D-DIS').checked=false;
                $('D-EN').checked=true;              
            }

            //均衡使能
            if(Json.ID_0x0370==0x55)
            {
                $('B-DIS').checked=true;
                $('B-EN').checked=false; 
            }
            else if(Json.ID_0x0370==0xAA)
            {
                $('B-DIS').checked=false;
                $('B-EN').checked=true;              
            }

            //PCS离网启动策略
            if(Json.ID_0x0371==0)
            {
                $('ALL-NORMAL').checked=true;
                $('PART-NORMAL').checked=false; 
            }
            else if(Json.ID_0x0371==1)
            {
                $('ALL-NORMAL').checked=false;
                $('PART-NORMAL').checked=true;              
            } 

            //PV通讯模式
            if(Json.ID_0x0387==0)
            {
                $('PV-UART').checked=true;
                $('PV-NET').checked=false;
            }
            else if(Json.ID_0x0387==1)
            {
                $('PV-UART').checked=false;
                $('PV-NET').checked=true;              
            }    

            //电表协议
            if(Json.ID_0x036F == 0)
            {
                $('AMMETER-MODBUS').checked=true;
                $('AMMETER-DLT645').checked=false;
            }
            else if(Json.ID_0x036F == 1)
            {
                $('AMMETER-MODBUS').checked=false;
                $('AMMETER-DLT645').checked=true;
            }       
        }
    </script>
</html>
