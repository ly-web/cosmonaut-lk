<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=GB2312'/>
        <link type='text/css' href='c_000.css' rel='stylesheet'/>
        <script src='j_001.js' type='text/javascript'></script>
        <style type='text/css'>
        tr{height:27px;}
        .td1{text-align:left;padding-left:40px;}
        .td2{text-align:right;padding-right:5px;}
        .td3{text-align:right;padding-right:40px;}
        .div_tab{width:780px;height:45px;margin:0 auto;}
        .div_btn{width:80px;margin:0 auto;height:30px;text-align:right;margin-top:8px;float:left;}
        .div_text{width:80px;margin:0 auto;height:25px;text-align:right;margin-top:10px;float:left;}
        .div_span{width:40px;margin:0 auto;height:25px;font-size:16px;font-weight:bold;text-align:right;margin-top:12px;float:left;}
        .btn{width:75px;height:30px;}
        .PagerView{font-size:14px;font-family:tahoma,arial;font-weight:bold;color:#333;text-align:center;padding:8px;line-height:100%;}
        .PagerView span{color:#999;margin:0 1px;padding:3px 6px;border:1px solid #ccc;}
        .PagerView span.on{color:#fff;font-weight:bold;border:1px solid #666;background:#888;} 
        .PagerView a{color:#00f;text-decoration:none;}
        .PagerView a span{color:#33f;border:1px solid #888;}
        .pager{width:780px;margin:0 auto;}
        </style>
        <script type='text/javascript'>
            var CHANNEL1_NAME=new Array('N003','N004','N005');
            var CHANNEL1_ID=new Array('ID_0x8000','ID_0x8001','ID_0x8002');
            var CHANNEL1_UNIT=new Array('W/m2','Wh/m2','Wh/m2');
    
            var CHANNEL2_NAME=new Array('N007','N008','N009');
            var CHANNEL2_ID=new Array('ID_0x8003','ID_0x8004','ID_0x8005');
            var CHANNEL2_UNIT=new Array('W/m2','Wh/m2','Wh/m2');

            var ST_NAME=new Array('N011','N012','N013','N014','N015','N016','N017','N018');
            var ST_ID=new Array('ID_0x8006','ID_0x8007','ID_0x8008','ID_0x8009','ID_0x800A','ID_0x800B','ID_0x800C','ID_0x800D');
            var ST_UNIT=new Array('m/s','Level','℃','','hPa','℃','℃','%RH');

            function show_SUB(TR1,TR2,TR3)
            {
                var str='';
                str+="<table width='90%' border='0'>";
                for(var i=0;i<TR1.length;i+=2)
                {
                    str+="<tr id='"+TR1[i]+i+"'>";
                        str+="<td width='20%' class='td1 "+(i%4?"even":"odd")+"'><span id='"+TR1[i]+"'></span></td>";
                        str+="<td width='20%' class='td2 "+(i%4?"even":"odd")+"'><span id='"+TR2[i]+"'></span></td>";
                        str+="<td width='10%' class='td3 "+(i%4?"even":"odd")+"'>"+TR3[i]+"</td>";
                        if(i+1!=TR1.length)
                        {
                            str+="<td width='20%' class='td1 "+(i%4?"even":"odd")+"'><span id='"+TR1[i+1]+"'></span></td>";
                            str+="<td width='20%' class='td2 "+(i%4?"even":"odd")+"'><span id='"+TR2[i+1]+"'></span></td>";
                            str+="<td width='10%' class='td3 "+(i%4?"even":"odd")+"'>"+TR3[i+1]+"</td>";
                        }
                        else
                        {
                            str+="<td width='20%' class='td1 "+(i%4?"even":"odd")+"'></td>";
                            str+="<td width='20%' class='td2 "+(i%4?"even":"odd")+"'></td>";
                            str+="<td width='10%' class='td3 "+(i%4?"even":"odd")+"'></td>";
                        }
                        
                    str+="</tr>";
                }
                str+="</table>";
                document.write(str);
            }
        </script>
    </head>
    <body onload='Init();'>
        <script type='text/javascript'>
            show_T('N001');
        </script>        
        <div class='line_long'></div>
        <div class='blank'></div>
        <script type='text/javascript'>
            show_sT('N002');
            show_SUB(CHANNEL1_NAME,CHANNEL1_ID,CHANNEL1_UNIT);
        </script>
        <div class='line_long'></div>
        <div class='blank'></div>     
        <script type='text/javascript'>
            show_sT('N006');
            show_SUB(CHANNEL2_NAME,CHANNEL2_ID,CHANNEL2_UNIT);
        </script>  
        <div class='line_long'></div>
        <div class='blank'></div>  
        <script type='text/javascript'>
            show_sT('N010');
            show_SUB(ST_NAME,ST_ID,ST_UNIT);
        </script>  
        <div class='line_long'></div>
        <div class='blank'></div>  
        <!--[if IE 6]><script type='text/javascript'>document.execCommand('BackgroundImageCache',false,true);</script><![endif]-->
    </body>
    <script type='text/javascript'>
        window.history.forward(1);
        var $=function(o){return document.getElementById(o);};
        var language=0;
        var Json;
        var CurBms;
        var lang=
        {
            N001:['环境监测仪信息','Env-Detector Information'],

            N002:['通道一信息','Channel1 Information'],
            N003:['日照辐射强度1','Sunshine Radiation Intensity1'],
            N004:['日辐射量1','Day Radiation1'],
            N005:['总辐射量1','All Radiation1'],

            N006:['通道二信息','Channel2 Information'],
            N007:['日照辐射强度2','Sunshine Radiation Intensity2'],
            N008:['日辐射量2','Day Radiation2'],
            N009:['总辐射量2','All Radiation2'],

            N010:['环境信息','Environment Information'],
            N011:['风速','Wind Speed'],
            N012:['风速等级','Wind Speed Level'],
            N013:['风向度数','Degree of Wind Direction'],
            N014:['风向位置','Wind Position'],
            N015:['大气压力','Atmospheric Pressure'],
            N016:['电池板温度','Battery Board Temperature'],
            N017:['环境温度','Environment Temperature'],
            N018:['环境湿度','Environment Humidity']
        }; 

        var WindPosition=
        {
            N0:['北','North'],
            N1:['东北偏北','North by northeast'],
            N2:['东北','Northeast'],
            N3:['东北偏东','East by Northeast'],
            N4:['东','East'],   
            N5:['东南偏东','East by Southeast'],
            N6:['东南','Southeast'],
            N7:['东南偏南','South by Southeast'],
            N8:['南','South'],
            N9:['西南偏南','South by Southwest'],
            N10:['西南','Southwest'],
            N11:['西南偏西','West by Southwest'],
            N12:['西','West'],
            N13:['西北偏西','West by Northwest'],
            N14:['西北','Northwest'],
            N15:['西北偏北','North by Northwest']
        };

        function ajax()
        {
            Json={ID_0x0301:0x55,ID_0x8000:6500,ID_0x8001:200,ID_0x8002:500,ID_0x8003:6500,ID_0x8004:100,ID_0x8005:500,ID_0x8006:40,ID_0x8007:3,ID_0x8008:12,ID_0x8009:0x0f,ID_0x800A:12,ID_0x800B:12,ID_0x800C:12,ID_0x800D:12};
            var URL='s_045.html?time='+new Date();
            var xmlhttp;
            if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest();
            else xmlhttp=new ActiveXObject('Microsoft.XMLHTTP');
            //xmlhttp.onreadystatechange=function()
            {
                //if(xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    //eval('Json='+xmlhttp.responseText);           
                    if(Json.ID_0x0301==0x55)language=0;else language=1;
                    for(var i=1;i<=18;i++)
                    {
                        eval('$(\'N0'+(i<10?'0'+i:i)+'\').innerHTML=lang.N0'+(i<10?'0'+i:i)+'[language];');
                    }

                    $('ID_0x8000').innerHTML=(Json.ID_0x8000/10.0).toFixed(1);
                    $('ID_0x8001').innerHTML=(Json.ID_0x8001/100.0).toFixed(2);
                    $('ID_0x8002').innerHTML=(Json.ID_0x8002/10.0).toFixed(1);
                    $('ID_0x8003').innerHTML=(Json.ID_0x8003/10.0).toFixed(1);
                    $('ID_0x8004').innerHTML=(Json.ID_0x8004/100.0).toFixed(2);
                    $('ID_0x8005').innerHTML=(Json.ID_0x8005/10.0).toFixed(1);
                    $('ID_0x8006').innerHTML=(Json.ID_0x8006/10.0).toFixed(1);
                    $('ID_0x8007').innerHTML=Json.ID_0x8007;
                    $('ID_0x8008').innerHTML=(Json.ID_0x8008/10.0).toFixed(1);

                    eval("$('ID_0x8009').innerHTML=WindPosition.N"+Json.ID_0x8009+"["+language+"]");

                    $('ID_0x800A').innerHTML=(Json.ID_0x800A/10.0).toFixed(1);
                    $('ID_0x800B').innerHTML=(Json.ID_0x800B/10.0).toFixed(1);
                    $('ID_0x800C').innerHTML=(Json.ID_0x800C/10.0).toFixed(1);
                    $('ID_0x800D').innerHTML=(Json.ID_0x800D/10.0).toFixed(1);
                }
            };
            xmlhttp.open('GET',URL,true);
            xmlhttp.send();
        }        
        function Init()
        {
            ajax();
            setInterval('ajax()', 2000);
        }   
    </script>
</html>
